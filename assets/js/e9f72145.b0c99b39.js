"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[4790],{9902(e,t,n){n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Automations/usage/send-mail","title":"Send-Mail","description":"Send emails via SMTP with support for attachments, CC/BCC, and custom servers/ports.","source":"@site/docs/Automations/usage/send-mail.md","sourceDirName":"Automations/usage","slug":"/Automations/usage/send-mail","permalink":"/Nebula.KB-dev/Nebula/Automations/usage/send-mail","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Send-Mail","permalink":"/Nebula.KB-dev/Nebula/tags/send-mail"},{"inline":true,"label":"E-mail","permalink":"/Nebula.KB-dev/Nebula/tags/e-mail"},{"inline":true,"label":"Nebula.Automations","permalink":"/Nebula.KB-dev/Nebula/tags/nebula-automations"}],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Send-Mail","description":"Send emails via SMTP with support for attachments, CC/BCC, and custom servers/ports.","hide_title":true,"id":"send-mail","tags":["Send-Mail","E-mail","Nebula.Automations"]},"sidebar":"tutorialSidebar","previous":{"title":"Getting started","permalink":"/Nebula.KB-dev/Nebula/Automations/intro"},"next":{"title":"Test-MgGraphConnection","permalink":"/Nebula.KB-dev/Nebula/Automations/usage/test-mggraphconnection"}}');var i=n(4848),l=n(8453);const d={sidebar_position:1,title:"Send-Mail",description:"Send emails via SMTP with support for attachments, CC/BCC, and custom servers/ports.",hide_title:!0,id:"send-mail",tags:["Send-Mail","E-mail","Nebula.Automations"]},r="Send-Mail",a={},c=[{value:"Syntax",id:"syntax",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Examples",id:"examples",level:2},{value:"Questions and answers",id:"questions-and-answers",level:2},{value:"Does Send-Mail send HTML or plain text?",id:"does-send-mail-send-html-or-plain-text",level:3},{value:"Can I use TLS/authentication?",id:"can-i-use-tlsauthentication",level:3},{value:"How do I handle multiple recipients?",id:"how-do-i-handle-multiple-recipients",level:3},{value:"Are attachments supported?",id:"are-attachments-supported",level:3}];function o(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"send-mail",children:"Send-Mail"})}),"\n",(0,i.jsx)(t.p,{children:"Send emails via SMTP with support for attachments, CC/BCC, and custom servers/ports."}),"\n",(0,i.jsx)(t.h2,{id:"syntax",children:"Syntax"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:"Send-Mail -SMTPServer <String> -From <String> -To <String[]> -Subject <String> -Body <String>\n         [-SMTPPort <Int>] [-Cc <String[]>] [-Bcc <String[]>] [-AttachmentPath <String[]>]\n         [-PlainText] [-Credential <PSCredential>] [-UseSsl]\n"})}),"\n",(0,i.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Parameter"}),(0,i.jsx)(t.th,{children:"Description"}),(0,i.jsx)(t.th,{style:{textAlign:"center"},children:"Required"}),(0,i.jsx)(t.th,{children:"Default"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"SMTPServer"})}),(0,i.jsx)(t.td,{children:"Hostname or IP of the SMTP relay to use."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Yes"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"SMTPPort"})}),(0,i.jsx)(t.td,{children:"TCP port of the SMTP relay."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"25"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"From"})}),(0,i.jsx)(t.td,{children:"Sender email address."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Yes"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"To"})}),(0,i.jsx)(t.td,{children:"Recipient list (supports multiple values)."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Yes"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Cc"})}),(0,i.jsx)(t.td,{children:"CC recipient list."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:"Empty"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Bcc"})}),(0,i.jsx)(t.td,{children:"BCC recipient list."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:"Empty"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Subject"})}),(0,i.jsx)(t.td,{children:"Email subject."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Yes"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Body"})}),(0,i.jsx)(t.td,{children:"Email body (HTML is enabled by default)."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"Yes"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"AttachmentPath"})}),(0,i.jsx)(t.td,{children:"One or more file paths to attach."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:"Empty"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"PlainText"})}),(0,i.jsx)(t.td,{children:"Send the body as plain text (HTML is default)."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Credential"})}),(0,i.jsx)(t.td,{children:"PSCredential used for authenticated SMTP."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"UseSsl"})}),(0,i.jsx)(t.td,{children:"Enable SSL/TLS when connecting to SMTP."}),(0,i.jsx)(t.td,{style:{textAlign:"center"},children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})})]})]})]}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsxs)(t.p,{children:["The function relies on .NET ",(0,i.jsx)(t.code,{children:"System.Net.Mail.SmtpClient"}),". Auth/TLS are supported via ",(0,i.jsx)(t.code,{children:"-Credential"})," and ",(0,i.jsx)(t.code,{children:"-UseSsl"}),"; ensure your relay accepts the chosen method."]})}),"\n",(0,i.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.strong,{children:"Send a simple HTML email"})}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'Send-Mail `\n  -SMTPServer "smtp.internal.local" `\n  -From "automation@contoso.com" `\n  -To "team@contoso.com" `\n  -Subject "Job completed" `\n  -Body "<p>The overnight job finished successfully.</p>"\n'})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.strong,{children:"Add CC/BCC recipients and an attachment"})}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'Send-Mail `\n  -SMTPServer "smtp.internal.local" `\n  -SMTPPort 2525 `\n  -From "automation@contoso.com" `\n  -UseSsl `\n  -Credential (Get-Credential) `\n  -To "user1@contoso.com","user2@contoso.com" `\n  -Cc "lead@contoso.com" `\n  -Bcc "audit@contoso.com" `\n  -Subject "Weekly metrics" `\n  -Body "<p>Attached you will find the weekly metrics.</p>" `\n  -AttachmentPath "C:\\Exports\\metrics.xlsx","C:\\Exports\\trend.pdf"\n'})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.strong,{children:"Reusable helper inside a script"})}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'function Send-JobAlert {\n  param(\n    [string]$ReportPath,\n    [string]$Status\n  )\n\n  $subject = "Nightly job status: $Status"\n  $body = "<h2>Status: $Status</h2><p>See attached log.</p>"\n\n  Send-Mail -SMTPServer "smtp.example.com" -From "jobs@example.com" -To "ops@example.com" `\n    -Subject $subject -Body $body -AttachmentPath $ReportPath\n}\n'})}),"\n",(0,i.jsx)(t.admonition,{type:"tip",children:(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Multiple attachments are supported; paths must exist or the function throws."}),"\n",(0,i.jsxs)(t.li,{children:["HTML is enabled by default. Add ",(0,i.jsx)(t.code,{children:"-PlainText"})," if your relay/policy requires plain text bodies."]}),"\n",(0,i.jsxs)(t.li,{children:["Use ",(0,i.jsx)(t.code,{children:"-UseSsl"})," and ",(0,i.jsx)(t.code,{children:"-Credential"})," when relaying through authenticated/TLS SMTP servers."]}),"\n"]})}),"\n",(0,i.jsx)(t.h2,{id:"questions-and-answers",children:"Questions and answers"}),"\n",(0,i.jsx)(t.h3,{id:"does-send-mail-send-html-or-plain-text",children:"Does Send-Mail send HTML or plain text?"}),"\n",(0,i.jsxs)(t.p,{children:["HTML is enabled by default via ",(0,i.jsx)(t.code,{children:"System.Net.Mail.SmtpClient"}),". Add ",(0,i.jsx)(t.code,{children:"-PlainText"})," to force text-only output."]}),"\n",(0,i.jsx)(t.h3,{id:"can-i-use-tlsauthentication",children:"Can I use TLS/authentication?"}),"\n",(0,i.jsxs)(t.p,{children:["Yes. Use ",(0,i.jsx)(t.code,{children:"-UseSsl"})," and ",(0,i.jsx)(t.code,{children:"-Credential"})," (PSCredential) for authenticated SMTP on ports like 587; ensure the relay accepts that method."]}),"\n",(0,i.jsx)(t.h3,{id:"how-do-i-handle-multiple-recipients",children:"How do I handle multiple recipients?"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"-To"}),", ",(0,i.jsx)(t.code,{children:"-Cc"}),", and ",(0,i.jsx)(t.code,{children:"-Bcc"})," accept arrays: ",(0,i.jsx)(t.code,{children:'-To "a@contoso.com","b@contoso.com"'}),"."]}),"\n",(0,i.jsx)(t.h3,{id:"are-attachments-supported",children:"Are attachments supported?"}),"\n",(0,i.jsxs)(t.p,{children:["Yes. Use ",(0,i.jsx)(t.code,{children:"-AttachmentPath"}),"; paths must exist or the cmdlet throws."]})]})}function h(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453(e,t,n){n.d(t,{R:()=>d,x:()=>r});var s=n(6540);const i={},l=s.createContext(i);function d(e){const t=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(l.Provider,{value:t},e.children)}}}]);