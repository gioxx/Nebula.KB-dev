"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[8654],{7293(e,n,t){t.d(n,{A:()=>L});var r=t(6540),i=t(4848);function s(e){const{mdxAdmonitionTitle:n,rest:t}=function(e){const n=r.Children.toArray(e),t=n.find(e=>r.isValidElement(e)&&"mdxAdmonitionTitle"===e.type),s=n.filter(e=>e!==t),o=t?.props.children;return{mdxAdmonitionTitle:o,rest:s.length>0?(0,i.jsx)(i.Fragment,{children:s}):null}}(e.children),s=e.title??n;return{...e,...s&&{title:s},children:t}}var o=t(4164),a=t(1312),l=t(7559);const c="admonition_xJq3",d="admonitionHeading_Gvgb",u="admonitionIcon_Rf37",m="admonitionContent_BuS1";function h({type:e,className:n,children:t}){return(0,i.jsx)("div",{className:(0,o.A)(l.G.common.admonition,l.G.common.admonitionType(e),c,n),children:t})}function p({icon:e,title:n}){return(0,i.jsxs)("div",{className:d,children:[(0,i.jsx)("span",{className:u,children:e}),n]})}function x({children:e}){return e?(0,i.jsx)("div",{className:m,children:e}):null}function f(e){const{type:n,icon:t,title:r,children:s,className:o}=e;return(0,i.jsxs)(h,{type:n,className:o,children:[r||t?(0,i.jsx)(p,{title:r,icon:t}):null,(0,i.jsx)(x,{children:s})]})}function b(e){return(0,i.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})})}const j={icon:(0,i.jsx)(b,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.note",description:"The default label used for the Note admonition (:::note)",children:"note"})};function y(e){return(0,i.jsx)(f,{...j,...e,className:(0,o.A)("alert alert--secondary",e.className),children:e.children})}function g(e){return(0,i.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})})}const v={icon:(0,i.jsx)(g,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.tip",description:"The default label used for the Tip admonition (:::tip)",children:"tip"})};function w(e){return(0,i.jsx)(f,{...v,...e,className:(0,o.A)("alert alert--success",e.className),children:e.children})}function S(e){return(0,i.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})})}const q={icon:(0,i.jsx)(S,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.info",description:"The default label used for the Info admonition (:::info)",children:"info"})};function C(e){return(0,i.jsx)(f,{...q,...e,className:(0,o.A)("alert alert--info",e.className),children:e.children})}function k(e){return(0,i.jsx)("svg",{viewBox:"0 0 16 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})})}const N={icon:(0,i.jsx)(k,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.warning",description:"The default label used for the Warning admonition (:::warning)",children:"warning"})};function T(e){return(0,i.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"})})}const D={icon:(0,i.jsx)(T,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.danger",description:"The default label used for the Danger admonition (:::danger)",children:"danger"})};const z={icon:(0,i.jsx)(k,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.caution",description:"The default label used for the Caution admonition (:::caution)",children:"caution"})};const A={...{note:y,tip:w,info:C,warning:function(e){return(0,i.jsx)(f,{...N,...e,className:(0,o.A)("alert alert--warning",e.className),children:e.children})},danger:function(e){return(0,i.jsx)(f,{...D,...e,className:(0,o.A)("alert alert--danger",e.className),children:e.children})}},...{secondary:e=>(0,i.jsx)(y,{title:"secondary",...e}),important:e=>(0,i.jsx)(C,{title:"important",...e}),success:e=>(0,i.jsx)(w,{title:"success",...e}),caution:function(e){return(0,i.jsx)(f,{...z,...e,className:(0,o.A)("alert alert--warning",e.className),children:e.children})}}};function L(e){const n=s(e),t=(r=n.type,A[r]||(console.warn(`No admonition component found for admonition type "${r}". Using Info as fallback.`),A.info));var r;return(0,i.jsx)(t,{...n})}},6594(e,n,t){t.r(n),t.d(n,{default:()=>m});var r=t(6540),i=t(1656),s=t(7293),o=t(4848);function a(e,n){const t=[];let r="",i=!1;for(let s=0;s<e.length;s++){const o=e[s];'"'!==o?o!==n||i?r+=o:(t.push(r),r=""):i&&'"'===e[s+1]?(r+='"',s++):i=!i}return t.push(r),t}function l(e){const n=(e||"").match(/@([^@\s>]+)$/);return n?n[1].toLowerCase():""}const c=new Set(["gmail.com","outlook.com","outlook.it","hotmail.com","live.com","yahoo.com","yahoo.it","icloud.com","proton.me"]);function d(e){const n=(e||"").split(/\r?\n/).find(e=>e.trim())||"",t=(n.match(/,/g)||[]).length;return(n.match(/;/g)||[]).length>t?";":","}function u(e,n=","){const t=e.trim().split(/\r?\n/).filter(Boolean);if(!t.length)return{rows:[],types:[]};const r=a(t[0],n).map(e=>e.trim()),i=t.slice(1).map((e,t)=>{const i=a(e,n),s={};return r.forEach((e,n)=>s[e]=i[n]??""),{id:`${t}-${s.Identity||s.SenderAddress||""}`,sender:s.SenderAddress||"",recipient:s.RecipientAddress||"",senderDomain:l(s.SenderAddress),recipientDomain:l(s.RecipientAddress),subject:s.Subject||"",identity:s.Identity||"",received:s.ReceivedTime||"",quarantineType:s.QuarantineTypes||"",released:"true"===(s.Released||"").toLowerCase(),raw:s}}),s=[...new Set(i.map(e=>e.quarantineType).filter(Boolean))].sort(),o=[...new Set(i.map(e=>e.senderDomain).filter(Boolean))].sort();return{rows:i,types:s,senderDomains:o}}function m(){const[e,n]=(0,r.useState)(""),[t,a]=(0,r.useState)([]),[l,m]=(0,r.useState)([]),[h,p]=(0,r.useState)([]),[x,f]=(0,r.useState)(""),[b,j]=(0,r.useState)({}),[y,g]=(0,r.useState)({}),[v,w]=(0,r.useState)(""),[S,q]=(0,r.useState)({}),[C,k]=(0,r.useState)({column:null,direction:null}),[N,T]=(0,r.useState)(""),[D,z]=(0,r.useState)(new Set),[A,L]=(0,r.useState)(new Set),[R,E]=(0,r.useState)(new Set),[M,$]=(0,r.useState)(new Set),[I,B]=(0,r.useState)(!1),F=(0,r.useRef)(null),H=(0,r.useRef)(null),O=(0,r.useMemo)(()=>function(e){const n=e.length,t=e.filter(e=>e.released).length,r=e.reduce((e,n)=>(e[n.quarantineType||""]=(e[n.quarantineType||""]||0)+1,e),{}),i=new Set(e.map(e=>e.sender)).size,s=new Set(e.map(e=>e.recipient)).size,o=e.reduce((e,n)=>n.senderDomain?(e[n.senderDomain]=(e[n.senderDomain]||0)+1,e):e,{});return{total:n,released:t,notReleased:n-t,byType:r,uniqueSenders:i,uniqueRecipients:s,senderDomainCount:o,topSenderDomains:Object.entries(o).sort((e,n)=>n[1]-e[1]).slice(0,3).map(([e,n])=>({domain:e,count:n}))}}(t),[t]),V=(0,r.useMemo)(()=>function(e,n){const t=n.text.toLowerCase();return e.filter(e=>{if(n.domainSelection&&Object.keys(n.domainSelection).length&&!1===n.domainSelection[e.senderDomain])return!1;if(n.excludedRows&&n.excludedRows.has(e.id))return!1;if(n.excludedSenders&&n.excludedSenders.has(e.sender))return!1;if(n.excludedDomains&&n.excludedDomains.has(e.senderDomain))return!1;if(n.excludedSubjects&&n.excludedSubjects.has(e.subject))return!1;if(n.flagSelection&&Object.keys(n.flagSelection).length){const t=[],r=(n.senderDomainCount?.[e.senderDomain]||0)>1;if(r&&t.push("Frequent"),e.quarantineType&&t.push(e.quarantineType),!Object.entries(n.flagSelection).filter(([,e])=>!1!==e).map(([e])=>e).length)return!1;const i=!1!==n.flagSelection.Frequent;if(i&&!r)return!1;if(!i&&r)return!1;if(!t.some(e=>!1!==n.flagSelection[e]))return!1}return!(t&&!(e.sender.toLowerCase().includes(t)||e.recipient.toLowerCase().includes(t)||e.subject.toLowerCase().includes(t)||e.identity.toLowerCase().includes(t)))})}(t,{text:x,domainSelection:b,flagSelection:y,senderDomainCount:O.senderDomainCount,excludedRows:D,excludedSenders:A,excludedDomains:R,excludedSubjects:M}),[t,x,b,y,O.senderDomainCount,D,A,R,M]),W=(0,r.useMemo)(()=>{const e=O.senderDomainCount||{};return[...h].sort((n,t)=>{const r=(e[t]||0)-(e[n]||0);return 0!==r?r:n.localeCompare(t)})},[h,O.senderDomainCount]),P=(0,r.useMemo)(()=>Object.entries(O.byType||{}).filter(([,e])=>e>0).sort((e,n)=>{const t=n[1]-e[1];return 0!==t?t:e[0].localeCompare(n[0])}).map(([e])=>e),[O.byType]),U=(0,r.useMemo)(()=>{const e=[];return O&&Object.values(O.senderDomainCount||{}).some(e=>e>1)&&e.push("Frequent"),P.forEach(n=>e.push(n)),e},[O,P]),_=(0,r.useMemo)(()=>{if(!C.column||!C.direction)return V;const e="asc"===C.direction?1:-1,n=e=>"number"==typeof e?e:String(e??"").toLowerCase(),t=e=>{switch(C.column){case"sender":return n(e.sender);case"recipient":return n(e.recipient);case"subject":return n(e.subject);case"received":return(e=>{const n=(e||"").match(/(\d{2})\/(\d{2})\/(\d{4}) (\d{2}):(\d{2}):(\d{2})/);if(!n)return null;const t=`${n[3]}-${n[2]}-${n[1]}T${n[4]}:${n[5]}:${n[6]}Z`,r=Date.parse(t);return Number.isNaN(r)?null:r})(e.received)??n(e.received);case"identity":return n(e.identity);default:return n("")}};return[...V].sort((n,r)=>{const i=t(n),s=t(r);return i<s?-1*e:i>s?1*e:0})},[V,C]);function G(e,n){const t=`${e}-${n}`;q(e=>({...e,[t]:!e[t]}))}async function Q(e,n="Copied to clipboard."){try{await navigator.clipboard.writeText(e),T(n),setTimeout(()=>T(""),2e3)}catch(t){T("Copy failed. Your browser may block clipboard access."),setTimeout(()=>T(""),3e3)}}function Z(e){k(n=>n.column!==e?{column:e,direction:"asc"}:"asc"===n.direction?{column:e,direction:"desc"}:{column:null,direction:null})}function Y(e){return C.column!==e?"":"asc"===C.direction?" \u2191":"desc"===C.direction?" \u2193":""}return(0,r.useEffect)(()=>{const e=()=>H.current?.scrollWidth;return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{const e=()=>{B(window.scrollY>200)};return e(),window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[]),(0,o.jsxs)(i.A,{title:"Quarantine Email Analyzer",description:"Analyze quarantine email CSV files in the browser",children:[(0,o.jsx)("style",{children:"\n                .qea-tableWrapper { overflow-x: auto; margin-top: 1rem; width: 100%; }\n                .qea-tableWrapper table { width: 100%; }\n                .qea-table { font-size: 0.85rem; }\n                .qea-table th, .qea-table td { padding: 0.35rem 0.5rem; }\n                .qea-summaryCard { border: 1px solid var(--ifm-toc-border-color); border-radius: var(--ifm-global-radius); padding: .75rem 1rem; margin: 1rem 0; }\n                .qea-cell { display: block; width: 100%; max-width: 240px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; font-size: 0.82rem; }\n                .qea-cellSubject { max-width: 340px; }\n                .qea-cellSubjectShort { max-width: none; white-space: normal; }\n                .qea-cellExpanded { white-space: pre-wrap; overflow: visible; }\n                .qea-flag { display: inline-block; padding: 0.05rem 0.35rem; border-radius: 0.4rem; font-size: 0.7rem; margin-right: 0.2rem; }\n                .qea-flag-warn { background: var(--ifm-color-danger-contrast-background); color: var(--ifm-color-danger); }\n                .qea-flag-info { background: var(--ifm-color-primary-contrast-background); color: var(--ifm-color-primary); border: 1px solid var(--ifm-color-primary); }\n                .qea-domainList { max-height: 180px; overflow-y: auto; border: 1px solid var(--ifm-toc-border-color); border-radius: var(--ifm-global-radius); padding: 0.35rem 0.5rem; font-size: 0.85rem; background: var(--ifm-background-surface-color); }\n                .qea-domainList label { display: flex; align-items: center; gap: 0.35rem; margin-bottom: 0.25rem; }\n                .qea-small { font-size: 0.78rem; color: var(--ifm-color-secondary-text); }\n                .qea-selectActions { display: flex; gap: 0.5rem; margin-top: 4px; margin-bottom: 4px; }\n                .qea-selectLink { cursor: pointer; color: var(--ifm-color-primary); font-size: 0.82rem; }\n                .qea-selectLink:hover { text-decoration: underline; }\n                .qea-identityInput { width: 100%; min-width: 0; font-size: 0.78rem; padding: 0.15rem 0.25rem; border: 1px solid var(--ifm-toc-border-color); border-radius: var(--ifm-global-radius); background: var(--ifm-background-surface-color); }\n                .qea-titleIcon { display: inline-flex; align-items: center; justify-content: center; color: var(--ifm-color-primary); }\n                .qea-rowCommonDomain td { background: rgba(255, 181, 64, 0.12); }\n            "}),(0,o.jsxs)("main",{className:"container margin-vert--lg",children:[(0,o.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"center",marginBottom:"0.35rem"},children:[(0,o.jsx)("span",{className:"qea-titleIcon","aria-hidden":"true",children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{width:64,height:64},children:[(0,o.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,o.jsx)("path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2"}),(0,o.jsx)("path",{d:"M4 16v2a2 2 0 0 0 2 2h2"}),(0,o.jsx)("path",{d:"M16 4h2a2 2 0 0 1 2 2v2"}),(0,o.jsx)("path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2"}),(0,o.jsx)("path",{d:"M8 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"}),(0,o.jsx)("path",{d:"M16 16l-2.5 -2.5"})]})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"margin-bottom--sm",children:"Quarantine Email Analyzer"}),(0,o.jsx)("p",{style:{marginBottom:0},children:"Upload or paste a quarantine CSV to quickly filter senders, recipients, and decide what to release."})]})]}),(0,o.jsx)("p",{style:{fontSize:".85rem",color:"var(--ifm-color-secondary-text)",marginTop:"1rem"},children:(0,o.jsxs)(s.A,{type:"danger",title:"Data Privacy",children:["Everything stays in your browser; no files are uploaded or stored on the server.",(0,o.jsx)("br",{}),"All analysis is performed by your browser."]})}),(0,o.jsxs)("div",{className:"margin-bottom--sm",children:[(0,o.jsxs)("label",{className:"button button--secondary button--sm",style:{cursor:"pointer",marginRight:"0.5rem"},children:["Choose CSV",(0,o.jsx)("input",{type:"file",accept:".csv,.txt",style:{display:"none"},onChange:function(e){const t=e.target.files?.[0];if(!t)return;const r=new FileReader;r.onload=e=>{const r=e.target.result||"";n(r);const i=d(r),{rows:s,types:o,senderDomains:l}=u(r,i);a(s),m(o),p(l),j(l.reduce((e,n)=>(e[n]=!0,e),{})),g(["Frequent",...o].reduce((e,n)=>(e[n]=!0,e),{})),w(`Loaded ${t.name} (${t.size} bytes)`)},r.readAsText(t)}})]}),(0,o.jsx)("button",{className:"button button--primary button--sm",onClick:function(){const n=d(e),{rows:t,types:r,senderDomains:i}=u(e,n);a(t),m(r),p(i),j(i.reduce((e,n)=>(e[n]=!0,e),{})),g(["Frequent",...r].reduce((e,n)=>(e[n]=!0,e),{})),w(t.length?"Parsed from pasted text":"")},children:"Analyze"}),v&&(0,o.jsx)("span",{style:{marginLeft:"0.75rem",fontSize:".9rem"},children:v})]}),(0,o.jsx)("textarea",{style:{width:"100%",minHeight:180,marginTop:"1rem"},placeholder:"Paste CSV here... delimiter is auto-detected (comma or semicolon).",value:e,onChange:e=>n(e.target.value)}),t.length>0&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"qea-summaryCard",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:"Total:"})," ",O.total," -"," ",(0,o.jsx)("strong",{children:"Unique senders:"})," ",O.uniqueSenders," -"," ",(0,o.jsx)("strong",{children:"Unique recipients:"})," ",O.uniqueRecipients]}),(0,o.jsx)("div",{style:{marginTop:".4rem"},children:Object.entries(O.byType).map(([e,n],t)=>(0,o.jsxs)("span",{children:[(0,o.jsx)("strong",{children:e||"(empty)"}),": ",n,t<Object.entries(O.byType).length-1?" - ":""]},e))}),O.topSenderDomains.length>0&&(0,o.jsxs)("div",{style:{marginTop:".4rem"},children:[(0,o.jsx)("strong",{children:"Top sender domains:"})," ",O.topSenderDomains.map((e,n)=>(0,o.jsxs)("span",{children:[(0,o.jsx)("code",{children:e.domain})," (",e.count,")",n<O.topSenderDomains.length-1?", ":""]},e.domain))]})]}),(0,o.jsxs)("div",{className:"row margin-top--md margin-bottom--sm",children:[(0,o.jsxs)("div",{className:"col col--4",children:[(0,o.jsx)("span",{style:{fontSize:"0.85rem"},children:"Sender domains (uncheck to exclude)"}),(0,o.jsxs)("div",{className:"qea-selectActions",children:[(0,o.jsx)("span",{className:"qea-selectLink",onClick:()=>j(W.reduce((e,n)=>(e[n]=!0,e),{})),children:"Select all"}),(0,o.jsx)("span",{className:"qea-selectLink",onClick:()=>j(W.reduce((e,n)=>(e[n]=!1,e),{})),children:"Deselect all"})]}),(0,o.jsxs)("div",{className:"qea-domainList",style:{marginTop:4},children:[0===W.length&&(0,o.jsx)("div",{style:{color:"var(--ifm-color-secondary-text)"},children:"No domains detected"}),W.map(e=>{const n=!1!==b[e],t=O.senderDomainCount[e]||0;return(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"checkbox",checked:n,onChange:()=>{return n=e,void j(e=>({...e,[n]:!(e[n]??1)}));var n}}),(0,o.jsxs)("span",{style:{whiteSpace:"nowrap"},children:[e," (",t,")"]})]},e)})]})]}),(0,o.jsxs)("div",{className:"col col--4",children:[(0,o.jsx)("span",{style:{fontSize:"0.85rem"},children:"Flags (uncheck to exclude)"}),(0,o.jsxs)("div",{className:"qea-selectActions",children:[(0,o.jsx)("span",{className:"qea-selectLink",onClick:()=>g(U.reduce((e,n)=>(e[n]=!0,e),{})),children:"Select all"}),(0,o.jsx)("span",{className:"qea-selectLink",onClick:()=>g(U.reduce((e,n)=>(e[n]=!1,e),{})),children:"Deselect all"})]}),(0,o.jsxs)("div",{className:"qea-domainList",style:{marginTop:4},children:[0===U.length&&(0,o.jsx)("div",{style:{color:"var(--ifm-color-secondary-text)"},children:"No flags detected"}),U.map(e=>{const n=!1!==y[e];return(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"checkbox",checked:n,onChange:()=>g(n=>({...n,[e]:!(n[e]??1)}))}),(0,o.jsx)("span",{style:{whiteSpace:"nowrap"},children:e})]},e)})]})]}),(0,o.jsxs)("div",{className:"col col--4",children:[(0,o.jsx)("span",{style:{fontSize:"0.85rem"},children:"Search (sender/recipient/subject/id)"}),(0,o.jsx)("input",{type:"text",style:{width:"100%",marginTop:4},value:x,onChange:e=>f(e.target.value),placeholder:"e.g. @example.com or HighConfPhish"})]})]}),(0,o.jsxs)("p",{style:{fontSize:".9rem",color:"var(--ifm-color-secondary-text)"},children:["Showing ",V.length," of ",t.length," rows."]}),(0,o.jsx)("p",{style:{fontSize:".85rem",color:"var(--ifm-color-secondary-text)",marginTop:"-0.35rem"},children:'Righe con domini consumer comuni (es. gmail.com, outlook.com) sono evidenziate per valutare rapidamente l\'uso di "Exclude Domain".'}),(0,o.jsx)("p",{style:{fontSize:".85rem",color:"var(--ifm-color-secondary-text)",marginTop:"-0.35rem"},children:(0,o.jsxs)(s.A,{type:"tip",children:["Click column headers to sort (A-Z / Z-A / none).",(0,o.jsx)("br",{}),'If you deselect the flag "Frequent", rows marked as Frequent are always hidden even if they have other flags.']})}),(0,o.jsxs)("div",{className:"margin-top--sm margin-bottom--sm",style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[(0,o.jsx)("button",{type:"button",className:"button button--secondary button--sm",onClick:function(){const e=_.map(e=>e.identity).filter(Boolean);if(!e.length)return T("No identities to copy."),void setTimeout(()=>T(""),2e3);const n=e.length,t=1===n?"ID":"IDs";Q(e.join("\n"),`Copied ${n} ${t} to clipboard.`)},disabled:!_.length,children:"Copy all visible IDs"}),(0,o.jsx)("button",{type:"button",className:"button button--secondary button--sm",onClick:function(){f(""),j(h.reduce((e,n)=>(e[n]=!0,e),{})),g(U.reduce((e,n)=>(e[n]=!0,e),{})),k({column:null,direction:null}),q({}),z(new Set),L(new Set),E(new Set),$(new Set)},children:"Reset view"}),N&&(0,o.jsx)("span",{style:{fontSize:".85rem",color:"var(--ifm-color-secondary-text)"},children:N})]}),(0,o.jsx)("div",{className:"qea-tableWrapper",ref:F,children:(0,o.jsxs)("table",{className:"table qea-table",ref:H,children:[(0,o.jsxs)("colgroup",{children:[(0,o.jsx)("col",{}),(0,o.jsx)("col",{}),(0,o.jsx)("col",{style:{width:"36%"}}),(0,o.jsx)("col",{style:{width:"12%"}}),(0,o.jsx)("col",{style:{width:"12%"}})]}),(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsxs)("th",{style:{cursor:"pointer"},onClick:()=>Z("sender"),children:["Sender",Y("sender")]}),(0,o.jsxs)("th",{style:{cursor:"pointer"},onClick:()=>Z("recipient"),children:["Recipient",Y("recipient")]}),(0,o.jsxs)("th",{style:{cursor:"pointer"},onClick:()=>Z("subject"),children:["Subject",Y("subject")]}),(0,o.jsxs)("th",{style:{cursor:"pointer"},onClick:()=>Z("received"),children:["Received",Y("received")]}),(0,o.jsxs)("th",{style:{cursor:"pointer"},onClick:()=>Z("identity"),children:["Identity",Y("identity")]})]})}),(0,o.jsx)("tbody",{children:_.map((e,n)=>(0,o.jsxs)("tr",{className:c.has(e.senderDomain)?"qea-rowCommonDomain":void 0,children:[(0,o.jsxs)("td",{children:[(0,o.jsx)("div",{className:""+(S[`${e.id}-sender`]?"qea-cell qea-cellExpanded":"qea-cell"),children:e.sender}),(0,o.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.35rem",alignItems:"center"},children:[e.sender&&e.sender.length>28&&(0,o.jsx)("button",{type:"button",className:"button button--link button--sm",onClick:()=>G(e.id,"sender"),style:{padding:0},children:S[`${e.id}-sender`]?"Collapse":"Expand"}),(0,o.jsx)("button",{type:"button",className:"button button--link button--sm",style:{padding:0},onClick:()=>{return n=e.id,void z(e=>{const t=new Set(e);return t.add(n),t});var n},children:"Exclude"}),(0,o.jsx)("button",{type:"button",className:"button button--link button--sm",style:{padding:0},onClick:()=>{var n;(n=e.sender)&&L(e=>{const t=new Set(e);return t.add(n),t})},children:"Exclude Sender"}),(0,o.jsx)("button",{type:"button",className:"button button--link button--sm",style:{padding:0},onClick:()=>{var n;(n=e.senderDomain)&&E(e=>{const t=new Set(e);return t.add(n),t})},children:"Exclude Domain"})]})]}),(0,o.jsxs)("td",{children:[(0,o.jsx)("div",{className:""+(S[`${e.id}-recipient`]?"qea-cell qea-cellExpanded":"qea-cell"),children:e.recipient}),e.recipient&&e.recipient.length>28&&(0,o.jsx)("button",{type:"button",className:"button button--link button--sm",onClick:()=>G(e.id,"recipient"),style:{padding:0},children:S[`${e.id}-recipient`]?"Collapse":"Expand"})]}),(0,o.jsxs)("td",{children:[(0,o.jsx)("div",{className:S[`${e.id}-subject`]?"qea-cell qea-cellExpanded qea-cellSubject":(e.subject?.length||0)>80?"qea-cell qea-cellSubject":"qea-cell qea-cellSubject qea-cellSubjectShort",children:e.subject}),e.subject&&e.subject.length>80&&(0,o.jsx)("button",{type:"button",className:"button button--link button--sm",onClick:()=>G(e.id,"subject"),style:{padding:0},children:S[`${e.id}-subject`]?"Collapse":"Expand"}),(0,o.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.35rem",marginTop:"0.2rem"},children:(0,o.jsx)("button",{type:"button",className:"button button--link button--sm",style:{padding:0},onClick:()=>{var n;(n=e.subject)&&$(e=>{const t=new Set(e);return t.add(n),t})},children:"Exclude Subject"})}),(0,o.jsxs)("div",{style:{marginTop:"0.25rem"},children:[O.senderDomainCount[e.senderDomain]>1&&(0,o.jsx)("span",{className:"qea-flag qea-flag-info",children:"Frequent"}),e.quarantineType&&(0,o.jsx)("span",{className:"qea-flag qea-flag-warn",children:e.quarantineType})]})]}),(0,o.jsx)("td",{className:"qea-small",children:e.received}),(0,o.jsxs)("td",{className:"qea-small",children:[(0,o.jsx)("input",{className:"qea-identityInput",type:"text",readOnly:!0,value:e.identity}),e.identity&&(0,o.jsx)("button",{type:"button",className:"button button--link button--sm",style:{padding:0,marginTop:"0.15rem"},onClick:()=>{var n;(n=e.identity)&&Q(n)},children:"Copy"})]})]},e.id))})]})})]}),I&&(0,o.jsx)("button",{type:"button",className:"button button--primary button--sm",onClick:function(){window.scrollTo({top:0,behavior:"smooth"})},style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",borderRadius:"999px",boxShadow:"0 6px 18px rgba(0,0,0,0.18)",zIndex:40},"aria-label":"Back to top",children:"Back to top"})]})]})}}}]);