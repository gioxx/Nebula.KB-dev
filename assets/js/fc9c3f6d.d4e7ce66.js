"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[3975],{2115(e,s,n){n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"Core/usage/licenses","title":"Licenses","description":"Export tenant license assignments and inspect user licenses with friendly SKU names.","source":"@site/docs/Core/usage/licenses.md","sourceDirName":"Core/usage","slug":"/Core/usage/licenses","permalink":"/Nebula.KB-dev/Nebula/Core/usage/licenses","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Add-UserMsolAccountSku","permalink":"/Nebula.KB-dev/Nebula/tags/add-user-msol-account-sku"},{"inline":true,"label":"Copy-UserMsolAccountSku","permalink":"/Nebula.KB-dev/Nebula/tags/copy-user-msol-account-sku"},{"inline":true,"label":"Export-MsolAccountSku","permalink":"/Nebula.KB-dev/Nebula/tags/export-msol-account-sku"},{"inline":true,"label":"Get-TenantMsolAccountSku","permalink":"/Nebula.KB-dev/Nebula/tags/get-tenant-msol-account-sku"},{"inline":true,"label":"Get-UserMsolAccountSku","permalink":"/Nebula.KB-dev/Nebula/tags/get-user-msol-account-sku"},{"inline":true,"label":"Move-UserMsolAccountSku","permalink":"/Nebula.KB-dev/Nebula/tags/move-user-msol-account-sku"},{"inline":true,"label":"Remove-UserMsolAccountSku","permalink":"/Nebula.KB-dev/Nebula/tags/remove-user-msol-account-sku"},{"inline":true,"label":"Update-LicenseCatalog","permalink":"/Nebula.KB-dev/Nebula/tags/update-license-catalog"},{"inline":true,"label":"Nebula.Core","permalink":"/Nebula.KB-dev/Nebula/tags/nebula-core"},{"inline":true,"label":"Licenses","permalink":"/Nebula.KB-dev/Nebula/tags/licenses"}],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"Licenses","description":"Export tenant license assignments and inspect user licenses with friendly SKU names.","hide_title":true,"id":"licenses","tags":["Add-UserMsolAccountSku","Copy-UserMsolAccountSku","Export-MsolAccountSku","Get-TenantMsolAccountSku","Get-UserMsolAccountSku","Move-UserMsolAccountSku","Remove-UserMsolAccountSku","Update-LicenseCatalog","Nebula.Core","Licenses"]},"sidebar":"tutorialSidebar","previous":{"title":"Groups","permalink":"/Nebula.KB-dev/Nebula/Core/usage/groups"},"next":{"title":"Mailboxes","permalink":"/Nebula.KB-dev/Nebula/Core/usage/mailboxes"}}');var l=n(4848),c=n(8453);const t={sidebar_position:6,title:"Licenses",description:"Export tenant license assignments and inspect user licenses with friendly SKU names.",hide_title:!0,id:"licenses",tags:["Add-UserMsolAccountSku","Copy-UserMsolAccountSku","Export-MsolAccountSku","Get-TenantMsolAccountSku","Get-UserMsolAccountSku","Move-UserMsolAccountSku","Remove-UserMsolAccountSku","Update-LicenseCatalog","Nebula.Core","Licenses"]},i="License helpers",d={},o=[{value:"Add-UserMsolAccountSku",id:"add-usermsolaccountsku",level:2},{value:"Copy-UserMsolAccountSku",id:"copy-usermsolaccountsku",level:2},{value:"Export-MsolAccountSku",id:"export-msolaccountsku",level:2},{value:"Get-TenantMsolAccountSku",id:"get-tenantmsolaccountsku",level:2},{value:"Get-UserMsolAccountSku",id:"get-usermsolaccountsku",level:2},{value:"Move-UserMsolAccountSku",id:"move-usermsolaccountsku",level:2},{value:"Remove-UserMsolAccountSku",id:"remove-usermsolaccountsku",level:2},{value:"Update-LicenseCatalog",id:"update-licensecatalog",level:2},{value:"Questions and answers",id:"questions-and-answers",level:2},{value:"Can I export licenses/mailboxes without Graph?",id:"can-i-export-licensesmailboxes-without-graph",level:3}];function a(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.header,{children:(0,l.jsx)(s.h1,{id:"license-helpers",children:"License helpers"})}),"\n",(0,l.jsxs)(s.p,{children:["Backed by Microsoft Graph with a cached SKU catalog. For full details and examples, run ",(0,l.jsx)(s.code,{children:"Get-Help <FunctionName> -Detailed"}),"."]}),"\n",(0,l.jsx)(s.h2,{id:"add-usermsolaccountsku",children:"Add-UserMsolAccountSku"}),"\n",(0,l.jsx)(s.p,{children:"Assign licenses by friendly name (resolved via catalog), SKU part number, or SKU ID to a user."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Add-UserMsolAccountSku -UserPrincipalName <String> -License <String[]> [-ForceLicenseCatalogRefresh] [-ShowErrorDetails]\nAdd-UserMsolAccountSku <UserPrincipalName> -License <String[]> [-ForceLicenseCatalogRefresh] [-ShowErrorDetails]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Type"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"}),(0,l.jsx)(s.th,{children:"Default"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"UserPrincipalName"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsx)(s.td,{children:"Target user UPN or object ID."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,l.jsx)(s.td,{children:"-"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"License"})}),(0,l.jsx)(s.td,{children:"String[]"}),(0,l.jsx)(s.td,{children:"Friendly name, SKU part number, or SKU ID. Accepts multiple values."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,l.jsx)(s.td,{children:"-"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ForceLicenseCatalogRefresh"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Redownload license catalog cache."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ShowErrorDetails"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Include exception details in error messages."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Examples"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Add-UserMsolAccountSku -UserPrincipalName 'user@contoso.com' -License 'Microsoft 365 E3'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Add-UserMsolAccountSku -UserPrincipalName 'user@contoso.com' -License 'ENTERPRISEPACK','VISIOCLIENT'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Add-UserMsolAccountSku -UserPrincipalName 'user@contoso.com' -License '18181a46-0d4e-45cd-891e-60aabd171b4e'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Add-UserMsolAccountSku 'user@contoso.com' -License 'Microsoft 365 Business Standard EEA (no Teams)'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"'user1@contoso.com','user2@contoso.com' | Add-UserMsolAccountSku -License 'Microsoft 365 Business Standard EEA (no Teams)'\n"})}),"\n",(0,l.jsx)(s.admonition,{title:"Mandatory usage location parameter",type:"note",children:(0,l.jsxs)(s.p,{children:["If the target user has no ",(0,l.jsx)(s.code,{children:"UsageLocation"}),", Nebula.Core sets it automatically using the ",(0,l.jsx)(s.code,{children:"UsageLocation"})," key from your configuration (default ",(0,l.jsx)(s.code,{children:"US"}),", override via ",(0,l.jsx)(s.code,{children:"%USERPROFILE%\\.NebulaCore\\settings.psd1"}),"). If updating the usage location fails, license assignment stops."]})}),"\n",(0,l.jsx)(s.admonition,{title:"Licenses availability",type:"warning",children:(0,l.jsx)(s.p,{children:"If the tenant does not have units available for the requested license, the assignment is avoided and a warning message is displayed."})}),"\n",(0,l.jsx)(s.h2,{id:"copy-usermsolaccountsku",children:"Copy-UserMsolAccountSku"}),"\n",(0,l.jsx)(s.p,{children:"Copy all licenses (with disabled plans preserved) from one user to another without removing them from the source."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Copy-UserMsolAccountSku -SourceUserPrincipalName <String> -DestinationUserPrincipalName <String>\nCopy-UserMsolAccountSku <SourceUserPrincipalName> <DestinationUserPrincipalName>\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Type"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"}),(0,l.jsx)(s.th,{children:"Default"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"SourceUserPrincipalName"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsx)(s.td,{children:"Source user UPN or object ID."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,l.jsx)(s.td,{children:"-"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"DestinationUserPrincipalName"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsx)(s.td,{children:"Destination user UPN or object ID."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,l.jsx)(s.td,{children:"-"})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Copy-UserMsolAccountSku -SourceUserPrincipalName 'user1@contoso.com' -DestinationUserPrincipalName 'user2@contoso.com'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Copy-UserMsolAccountSku 'user1@contoso.com' 'user2@contoso.com'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"export-msolaccountsku",children:"Export-MsolAccountSku"}),"\n",(0,l.jsx)(s.p,{children:"Export all users with assigned licenses to CSV, mapping SKU part numbers to friendly names."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Export-MsolAccountSku [-CsvFolder <String>] [-ForceLicenseCatalogRefresh]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Type"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"}),(0,l.jsx)(s.th,{children:"Default"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"CsvFolder"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsx)(s.td,{children:"Output folder."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:"Current directory"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ForceLicenseCatalogRefresh"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Redownload the license catalog cache."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Export-MsolAccountSku -CsvFolder 'C:\\Temp\\Reports'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"get-tenantmsolaccountsku",children:"Get-TenantMsolAccountSku"}),"\n",(0,l.jsx)(s.p,{children:"List tenant SKUs with resolved names, totals, consumed, available (enabled minus consumed), and seat states (filter by name or SKU part number)."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-TenantMsolAccountSku [-ForceLicenseCatalogRefresh] [-Filter <String>] [-SampleUsers <Int32>] [-AsTable] [-GridView]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Type"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"}),(0,l.jsx)(s.th,{children:"Default"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ForceLicenseCatalogRefresh"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Redownload license catalog cache."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Filter"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsxs)(s.td,{children:["Show only licenses whose name or ",(0,l.jsx)(s.code,{children:"SkuPartNumber"})," contains the provided text."]}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:"-"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"SampleUsers"})}),(0,l.jsx)(s.td,{children:"Int32"}),(0,l.jsxs)(s.td,{children:["Return up to N sample users per license (requires ",(0,l.jsx)(s.code,{children:"-Filter"}),"). Defaults to 5 when specified."]}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"5"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"AsTable"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Format output as a table."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"GridView"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Show output in a GridView window."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-TenantMsolAccountSku -AsTable\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:'Get-TenantMsolAccountSku -Filter "E3" -AsTable\n'})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:'Get-TenantMsolAccountSku -Filter "E3" -SampleUsers\n'})}),"\n",(0,l.jsx)(s.admonition,{title:"Available licenses: how counting works",type:"note",children:(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"Available"})," is calculated as ",(0,l.jsx)(s.code,{children:"Enabled - Consumed"})," (never below zero). The ",(0,l.jsx)(s.code,{children:"Total"})," column shows a friendly breakdown (Enabled/Suspended), while ",(0,l.jsx)(s.code,{children:"TotalCount"})," remains the numeric total for scripting."]})}),"\n",(0,l.jsx)(s.admonition,{title:"Microsoft 365 Subscriptions (Admin Portal)",type:"tip",children:(0,l.jsxs)(s.p,{children:["Need renewal/expiration or billing profile details? Open the Microsoft 365 Admin Center subscriptions page: ",(0,l.jsx)(s.a,{href:"https://admin.cloud.microsoft/?#/subscriptions",children:"https://admin.cloud.microsoft/?#/subscriptions"})]})}),"\n",(0,l.jsx)(s.h2,{id:"get-usermsolaccountsku",children:"Get-UserMsolAccountSku"}),"\n",(0,l.jsx)(s.p,{children:"Show licenses assigned to a single user with friendly names."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-UserMsolAccountSku -UserPrincipalName <String> [-Clipboard] [-CheckAvailability] [-ForceLicenseCatalogRefresh] [-ShowErrorDetails]\nGet-UserMsolAccountSku <UserPrincipalName> [-Clipboard] [-CheckAvailability] [-ForceLicenseCatalogRefresh] [-ShowErrorDetails]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Type"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"}),(0,l.jsx)(s.th,{children:"Default"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"UserPrincipalName"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsx)(s.td,{children:"Target UPN or object ID."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,l.jsx)(s.td,{children:"-"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Clipboard"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsxs)(s.td,{children:["Copy the resolved license names (fallback: ",(0,l.jsx)(s.code,{children:"SkuPartNumber"}),") to the clipboard as ",(0,l.jsx)(s.code,{children:'"License1","License2"'}),"."]}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"CheckAvailability"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Show tenant available seat counts for the assigned SKUs."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ForceLicenseCatalogRefresh"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Redownload license catalog cache."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ShowErrorDetails"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Include exception details in error messages."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-UserMsolAccountSku -UserPrincipalName 'user@contoso.com'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"'user1@contoso.com','user2@contoso.com' | Get-UserMsolAccountSku\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-UserMsolAccountSku -UserPrincipalName 'user@contoso.com' -Clipboard\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-UserMsolAccountSku -UserPrincipalName 'user@contoso.com' -CheckAvailability\n"})}),"\n",(0,l.jsx)(s.h2,{id:"move-usermsolaccountsku",children:"Move-UserMsolAccountSku"}),"\n",(0,l.jsx)(s.p,{children:"Move all licenses (with disabled plans preserved) from one user to another."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Move-UserMsolAccountSku -SourceUserPrincipalName <String> -DestinationUserPrincipalName <String>\nMove-UserMsolAccountSku <SourceUserPrincipalName> <DestinationUserPrincipalName>\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Type"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"}),(0,l.jsx)(s.th,{children:"Default"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"SourceUserPrincipalName"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsx)(s.td,{children:"Source user UPN or object ID."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,l.jsx)(s.td,{children:"-"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"DestinationUserPrincipalName"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsx)(s.td,{children:"Destination user UPN or object ID."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,l.jsx)(s.td,{children:"-"})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Move-UserMsolAccountSku -SourceUserPrincipalName 'user1@contoso.com' -DestinationUserPrincipalName 'user2@contoso.com'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Move-UserMsolAccountSku 'user1@contoso.com' 'user2@contoso.com'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"remove-usermsolaccountsku",children:"Remove-UserMsolAccountSku"}),"\n",(0,l.jsx)(s.p,{children:"Remove licenses from a user by friendly name (resolved via catalog), SKU part number, or SKU ID."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-UserMsolAccountSku -UserPrincipalName <String> -License <String[]> [-ForceLicenseCatalogRefresh] [-ShowErrorDetails]\nRemove-UserMsolAccountSku <UserPrincipalName> -License <String[]> [-ForceLicenseCatalogRefresh] [-ShowErrorDetails]\n'user1@contoso.com','user2@contoso.com' | Remove-UserMsolAccountSku -License <String[]> [-ForceLicenseCatalogRefresh] [-ShowErrorDetails]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Type"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"}),(0,l.jsx)(s.th,{children:"Default"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"UserPrincipalName"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsx)(s.td,{children:"Target user UPN or object ID."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,l.jsx)(s.td,{children:"-"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"License"})}),(0,l.jsx)(s.td,{children:"String[]"}),(0,l.jsx)(s.td,{children:"Friendly name, SKU part number, or SKU ID. Accepts multiple values."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,l.jsx)(s.td,{children:"-"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ForceLicenseCatalogRefresh"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Redownload license catalog cache."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ShowErrorDetails"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Include exception details in error messages."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]})]})]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-UserMsolAccountSku -UserPrincipalName <String> -All [-ForceLicenseCatalogRefresh] [-ShowErrorDetails]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Type"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"}),(0,l.jsx)(s.th,{children:"Default"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"UserPrincipalName"})}),(0,l.jsx)(s.td,{children:"String"}),(0,l.jsx)(s.td,{children:"Target user UPN or object ID."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,l.jsx)(s.td,{children:"-"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"All"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Remove all assigned licenses."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,l.jsx)(s.td,{children:"-"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ForceLicenseCatalogRefresh"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Redownload license catalog cache."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ShowErrorDetails"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Include exception details in error messages."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Examples"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-UserMsolAccountSku -UserPrincipalName 'user@contoso.com' -License 'Microsoft 365 E3'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-UserMsolAccountSku -UserPrincipalName 'user@contoso.com' -License 'ENTERPRISEPACK','VISIOCLIENT'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-UserMsolAccountSku -UserPrincipalName 'user@contoso.com' -License '18181a46-0d4e-45cd-891e-60aabd171b4e'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-UserMsolAccountSku 'user@contoso.com' -License 'Exchange Online (Plan 2)'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"'user1@contoso.com','user2@contoso.com' | Remove-UserMsolAccountSku -License 'Exchange Online (Plan 1)'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-UserMsolAccountSku -UserPrincipalName 'user@contoso.com' -All\n"})}),"\n",(0,l.jsx)(s.h2,{id:"update-licensecatalog",children:"Update-LicenseCatalog"}),"\n",(0,l.jsx)(s.p,{children:"Refresh the local license catalog cache (download SKU mappings)."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Update-LicenseCatalog [-Force]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Type"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"}),(0,l.jsx)(s.th,{children:"Default"})]})}),(0,l.jsx)(s.tbody,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Force"})}),(0,l.jsx)(s.td,{children:"Switch"}),(0,l.jsx)(s.td,{children:"Force a refresh even if cache exists."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"False"})})]})})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Update-LicenseCatalog -Force\n"})}),"\n",(0,l.jsx)(s.h2,{id:"questions-and-answers",children:"Questions and answers"}),"\n",(0,l.jsx)(s.h3,{id:"can-i-export-licensesmailboxes-without-graph",children:"Can I export licenses/mailboxes without Graph?"}),"\n",(0,l.jsxs)(s.p,{children:["No. License functions and some statistics require Microsoft Graph for complete data. Ensure ",(0,l.jsx)(s.code,{children:"Connect-Nebula"})," requested the right scopes."]})]})}function h(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8453(e,s,n){n.d(s,{R:()=>t,x:()=>i});var r=n(6540);const l={},c=r.createContext(l);function t(e){const s=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),r.createElement(c.Provider,{value:s},e.children)}}}]);