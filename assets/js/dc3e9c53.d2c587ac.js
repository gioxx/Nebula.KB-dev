"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[5016],{7293(e,a,t){t.d(a,{A:()=>T});var n=t(6540),s=t(4848);function r(e){const{mdxAdmonitionTitle:a,rest:t}=function(e){const a=n.Children.toArray(e),t=a.find(e=>n.isValidElement(e)&&"mdxAdmonitionTitle"===e.type),r=a.filter(e=>e!==t),i=t?.props.children;return{mdxAdmonitionTitle:i,rest:r.length>0?(0,s.jsx)(s.Fragment,{children:r}):null}}(e.children),r=e.title??a;return{...e,...r&&{title:r},children:t}}var i=t(4164),l=t(1312),o=t(7559);const d="admonition_xJq3",c="admonitionHeading_Gvgb",h="admonitionIcon_Rf37",m="admonitionContent_BuS1";function u({type:e,className:a,children:t}){return(0,s.jsx)("div",{className:(0,i.A)(o.G.common.admonition,o.G.common.admonitionType(e),d,a),children:t})}function p({icon:e,title:a}){return(0,s.jsxs)("div",{className:c,children:[(0,s.jsx)("span",{className:h,children:e}),a]})}function x({children:e}){return e?(0,s.jsx)("div",{className:m,children:e}):null}function j(e){const{type:a,icon:t,title:n,children:r,className:i}=e;return(0,s.jsxs)(u,{type:a,className:i,children:[n||t?(0,s.jsx)(p,{title:n,icon:t}):null,(0,s.jsx)(x,{children:r})]})}function f(e){return(0,s.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})})}const g={icon:(0,s.jsx)(f,{}),title:(0,s.jsx)(l.A,{id:"theme.admonition.note",description:"The default label used for the Note admonition (:::note)",children:"note"})};function v(e){return(0,s.jsx)(j,{...g,...e,className:(0,i.A)("alert alert--secondary",e.className),children:e.children})}function b(e){return(0,s.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})})}const y={icon:(0,s.jsx)(b,{}),title:(0,s.jsx)(l.A,{id:"theme.admonition.tip",description:"The default label used for the Tip admonition (:::tip)",children:"tip"})};function N(e){return(0,s.jsx)(j,{...y,...e,className:(0,i.A)("alert alert--success",e.className),children:e.children})}function w(e){return(0,s.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})})}const k={icon:(0,s.jsx)(w,{}),title:(0,s.jsx)(l.A,{id:"theme.admonition.info",description:"The default label used for the Info admonition (:::info)",children:"info"})};function M(e){return(0,s.jsx)(j,{...k,...e,className:(0,i.A)("alert alert--info",e.className),children:e.children})}function z(e){return(0,s.jsx)("svg",{viewBox:"0 0 16 16",...e,children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})})}const A={icon:(0,s.jsx)(z,{}),title:(0,s.jsx)(l.A,{id:"theme.admonition.warning",description:"The default label used for the Warning admonition (:::warning)",children:"warning"})};function H(e){return(0,s.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"})})}const $={icon:(0,s.jsx)(H,{}),title:(0,s.jsx)(l.A,{id:"theme.admonition.danger",description:"The default label used for the Danger admonition (:::danger)",children:"danger"})};const S={icon:(0,s.jsx)(z,{}),title:(0,s.jsx)(l.A,{id:"theme.admonition.caution",description:"The default label used for the Caution admonition (:::caution)",children:"caution"})};const C={...{note:v,tip:N,info:M,warning:function(e){return(0,s.jsx)(j,{...A,...e,className:(0,i.A)("alert alert--warning",e.className),children:e.children})},danger:function(e){return(0,s.jsx)(j,{...$,...e,className:(0,i.A)("alert alert--danger",e.className),children:e.children})}},...{secondary:e=>(0,s.jsx)(v,{title:"secondary",...e}),important:e=>(0,s.jsx)(M,{title:"important",...e}),success:e=>(0,s.jsx)(N,{title:"success",...e}),caution:function(e){return(0,s.jsx)(j,{...S,...e,className:(0,i.A)("alert alert--warning",e.className),children:e.children})}}};function T(e){const a=r(e),t=(n=a.type,C[n]||(console.warn(`No admonition component found for admonition type "${n}". Using Info as fallback.`),C.info));var n;return(0,s.jsx)(t,{...a})}},2216(e,a,t){t.r(a),t.d(a,{default:()=>m});var n=t(6540),s=t(1656),r=t(7293),i=t(4848);function l(e){if(!e)return null;const a=new Date(e);return Number.isNaN(a.getTime())?null:a}function o(e,a=""){return e?e.toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"}):a}function d(e){return e.split(";").map(e=>e.trim()).filter(Boolean).map(e=>{const a=e.match(/^([^:=\s]+)\s*[:=]\s*(.+)$/);return{key:a?a[1].trim():e,value:a?a[2].trim():""}})}function c(e,a){const t=[];return(e||[]).forEach(e=>((e,a)=>{const n=[...e.matchAll(/\b(spf|dkim|dmarc|arc)=([a-z0-9_-]+)/gi)];n.length&&n.forEach(n=>{const s=n[1].toUpperCase(),r=n[2].toLowerCase(),i=e.slice(n.index+n[0].length).match(/header\.from=([^;\s]+)/i)||e.slice(n.index+n[0].length).match(/header\.d=([^;\s]+)/i)||e.slice(n.index+n[0].length).match(/smtp\.mailfrom=([^;\s]+)/i)||e.slice(n.index+n[0].length).match(/\bd=([^;\s]+)/i),l=e.slice(n.index+n[0].length).match(/\(([^)]*)\)/);t.push({mechanism:s,result:r,domain:i?i[1]:"",detail:l?l[1].trim():"",source:a})})})(e,"Authentication-Results")),(a||[]).forEach(e=>{const a=e.match(/^([A-Za-z]+)\s*\(/),n=a?a[1].toLowerCase():"",s=e.match(/sender\s+id\s+check\s+failed\s+for\s+([^;\s]+)/i)||e.match(/domain\s+of\s+([^;\s]+)/i);t.push({mechanism:"SPF",result:n||"unknown",domain:s?s[1]:"",detail:e,source:"Received-SPF"})}),t}function h(e){if(null==e)return"n/a";const a=e<0?"-":"",t=Math.abs(e);if(t<60)return`${a}${t} sec`;return`${a}${Math.floor(t/60)}m ${(t%60).toString().padStart(2,"0")}s`}function m(){const[e,a]=(0,n.useState)(""),[t,m]=(0,n.useState)(null),[u,p]=(0,n.useState)(""),[x,j]=(0,n.useState)(""),f=e=>{if(!e)return"";const a=[],t=e.summary||{};return a.push("=== Summary ==="),a.push(`Subject: ${t.subject||"n/a"}`),a.push(`Message ID: ${t.messageId||"n/a"}`),a.push(`From: ${t.from||"n/a"}`),a.push(`To: ${t.to||"n/a"}`),a.push(`Date: ${t.dateHeader||"n/a"}`),a.push(`Hops: ${t.hopCount??"n/a"}`),a.push(`Transit time: ${"number"==typeof t.totalTransitSeconds?h(t.totalTransitSeconds):"n/a"}`),a.push(""),a.push("=== Received path ==="),e.received?.length?e.received.forEach((e,t)=>{a.push(`Hop ${t+1}`),a.push(`  Submitting host: ${e.submittingHost||"n/a"}`),a.push(`  Receiving host: ${e.receivingHost||"n/a"}`),a.push(`  Time: ${e.dateString||"n/a"}`),a.push(`  Delay vs next: ${null===e.delaySeconds?"n/a":h(e.delaySeconds)}`),a.push(`  Protocol: ${e.protocol||"n/a"}`)}):a.push("No Received headers found."),a.push(""),a.push("=== Authentication ==="),e.auth?.length?e.auth.forEach(e=>{a.push(`- ${e.mechanism}: ${e.result} (${e.domain||"n/a"}) ${e.detail?"- "+e.detail:""}`)}):a.push("No SPF/DKIM/DMARC results detected."),a.push(""),a.push("=== X-Forefront-Antispam-Report ==="),e.forefront?.length?e.forefront.forEach(e=>a.push(`${e.key}: ${e.value||"n/a"}`)):a.push("No Forefront header found."),a.push(""),a.push("=== X-Microsoft-Antispam ==="),e.antispam?.length?e.antispam.forEach(e=>a.push(`${e.key}: ${e.value||"n/a"}`)):a.push("No Microsoft Antispam header found."),a.push(""),a.push("=== All headers ==="),e.entries?.length?e.entries.forEach((e,t)=>a.push(`${t+1}. ${e.name}: ${e.value}`)):a.push("No headers parsed."),a.join("\n")},g=t&&(!t.received||0===t.received.length),v=(0,n.useMemo)(()=>{const e=t?.summary||{},a="number"==typeof e.totalTransitSeconds?e.totalTransitSeconds:null;return[{label:"Subject",value:e.subject||"Not found"},{label:"Message ID",value:e.messageId||"Not found"},{label:"From",value:e.from||"Not found"},{label:"To",value:e.to||"Not found"},{label:"Date",value:e.dateObj?o(e.dateObj):e.dateHeader||"Not found"},{label:"Hops",value:"number"==typeof e.hopCount?`${e.hopCount} received headers`:"n/a"},{label:"Transit time",value:null!==a?h(a):"n/a"}]},[t]),b=({icon:e})=>(0,i.jsx)("span",{className:"mha-headerIcon","aria-hidden":"true",children:(0,i.jsx)("svg",{viewBox:"0 0 24 24",role:"presentation",stroke:"currentColor",strokeWidth:"1.8",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...e?.props||{},children:e?.nodes})}),y={paste:{nodes:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2"}),(0,i.jsx)("path",{d:"M9 5a2 2 0 0 0 2 2h2a2 2 0 0 0 2 -2"}),(0,i.jsx)("path",{d:"M9 11h3"}),(0,i.jsx)("path",{d:"M9 14h6"}),(0,i.jsx)("path",{d:"M9 17h6"})]})},summary:{nodes:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,i.jsx)("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),(0,i.jsx)("path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"}),(0,i.jsx)("path",{d:"M9 9l1 0"}),(0,i.jsx)("path",{d:"M9 13l6 0"}),(0,i.jsx)("path",{d:"M9 17l6 0"})]})},received:{nodes:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,i.jsx)("path",{d:"M3 17h4v4h-4z"}),(0,i.jsx)("path",{d:"M17 3h4v4h-4z"}),(0,i.jsx)("path",{d:"M11 19h5.5a3.5 3.5 0 0 0 0 -7h-8a3.5 3.5 0 0 1 0 -7h4.5"})]})},auth:{nodes:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,i.jsx)("path",{d:"M11.5 21h-4.5a2 2 0 0 1 -2 -2v-6a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v.5"}),(0,i.jsx)("path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0"}),(0,i.jsx)("path",{d:"M8 11v-4a4 4 0 1 1 8 0v4"}),(0,i.jsx)("path",{d:"M15 19l2 2l4 -4"})]})},antispam:{props:{fill:"currentColor",stroke:"none"},nodes:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,i.jsx)("path",{d:"M11.998 2l.118 .007l.059 .008l.061 .013l.111 .034a.993 .993 0 0 1 .217 .112l.104 .082l.255 .218a11 11 0 0 0 7.189 2.537l.342 -.01a1 1 0 0 1 1.005 .717a13 13 0 0 1 -9.208 16.25a1 1 0 0 1 -.502 0a13 13 0 0 1 -9.209 -16.25a1 1 0 0 1 1.005 -.717a11 11 0 0 0 7.531 -2.527l.263 -.225l.096 -.075a.993 .993 0 0 1 .217 -.112l.112 -.034a.97 .97 0 0 1 .119 -.021l.115 -.007zm3.71 7.293a1 1 0 0 0 -1.415 0l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.32 1.497l2 2l.094 .083a1 1 0 0 0 1.32 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z"})]})},headers:{nodes:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,i.jsx)("path",{d:"M11 19h-6a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v6"}),(0,i.jsx)("path",{d:"M3 7l9 6l9 -6"}),(0,i.jsx)("path",{d:"M20 21l2 -2l-2 -2"}),(0,i.jsx)("path",{d:"M17 17l-2 2l2 2"})]})}};return(0,i.jsxs)(s.A,{title:"Message Header Analyzer",description:"Inspect message headers entirely in your browser.",children:[(0,i.jsx)("style",{children:"\n                .mha-root { font-size: 0.94rem; }\n                .mha-layout { display: grid; gap: 1.25rem; }\n                .mha-actions { display: flex; gap: .5rem; flex-wrap: wrap; align-items: center; margin-bottom: 0.75rem; }\n                .mha-exportActions { display: flex; gap: .5rem; align-items: center; margin: 0.6rem 0 0.2rem; flex-wrap: wrap; }\n                .mha-textarea { width: 100%; min-height: 200px; font-family: inherit; font-size: inherit; line-height: inherit; }\n                .mha-card { border: 1px solid var(--ifm-toc-border-color); border-radius: 6px; overflow: hidden; background: var(--ifm-background-surface-color); }\n                .mha-cardHeader { background: #0067b8; color: #fff; padding: 0.45rem 0.7rem; font-weight: 700; letter-spacing: 0.01em; font-size: 0.94rem; display: flex; align-items: center; gap: 0.4rem; }\n                .mha-headerIcon { display: inline-flex; align-items: center; justify-content: center; }\n                .mha-headerIcon svg { width: 18px; height: 18px; vertical-align: middle; }\n                .mha-titleIcon { display: inline-flex; align-items: center; justify-content: center; margin-right: 0.45rem; vertical-align: middle; color: var(--ifm-color-primary); }\n                .mha-titleIcon svg { width: 26px; height: 26px; }\n                .mha-cardBody { padding: 0.7rem 0.85rem; }\n                .mha-summaryGrid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.6rem; }\n                .mha-summaryItem { padding: 0.5rem 0.55rem; border: 1px solid var(--ifm-toc-border-color); border-radius: 4px; background: var(--ifm-background-color); }\n                .mha-summaryLabel { display: block; font-size: 0.7rem; color: var(--ifm-color-secondary-text); text-transform: uppercase; letter-spacing: 0.04em; }\n                .mha-summaryValue { margin-top: 0.12rem; font-weight: 600; font-size: 0.92rem; word-break: break-word; }\n                .mha-tableWrapper { overflow-x: auto; }\n                .mha-table { width: 100%; border-collapse: collapse; font-size: 0.88rem; table-layout: fixed; }\n                .mha-table th, .mha-table td { padding: 0.45rem 0.5rem; border: 1px solid var(--ifm-toc-border-color); vertical-align: top; word-break: break-word; white-space: normal; }\n                .mha-table th { background: #e5f1fb; font-weight: 700; font-size: 0.88rem; color: var(--ifm-color-emphasis-600); }\n                .mha-table tr:nth-child(odd) { background: rgba(0,0,0,0.015); }\n                [data-theme='dark'] .mha-table th { background: #243447; color: var(--ifm-color-emphasis-400); }\n                [data-theme='dark'] .mha-table tr:nth-child(odd) { background: rgba(255,255,255,0.02); }\n                .mha-chip { display: inline-block; padding: 0.12rem 0.42rem; border-radius: 999px; font-size: 0.75rem; background: #e5f1fb; color: #004f9f; border: 1px solid #c6defa; }\n                .mha-delay-bad { color: var(--ifm-color-danger); font-weight: 700; }\n                .mha-delay-good { color: var(--ifm-color-success); font-weight: 700; }\n                .mha-mono { font-family: var(--ifm-font-family-monospace); font-size: 0.85rem; white-space: pre-wrap; }\n                .mha-center { text-align: center; vertical-align: middle; }\n                .mha-sectionHint { margin: 0.2rem 0 0; color: var(--ifm-color-secondary-text); font-size: 0.82rem; }\n                .mha-muted { color: var(--ifm-color-secondary-text); }\n                .mha-kvGrid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 0.55rem; }\n                .mha-kv { border: 1px solid var(--ifm-toc-border-color); border-radius: 4px; padding: 0.4rem 0.5rem; background: var(--ifm-background-color); font-size: 0.88rem; }\n                .mha-kv strong { font-size: 0.8rem; display: block; color: var(--ifm-color-secondary-text); text-transform: uppercase; letter-spacing: 0.03em; }\n                .mha-kv span { display: block; margin-top: 0.1rem; word-break: break-word; }\n                @media (max-width: 768px) {\n                    .mha-summaryGrid { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); }\n                    .mha-cardBody { padding: 0.65rem 0.7rem; }\n                }\n            "}),(0,i.jsxs)("main",{className:"container margin-vert--lg mha-root",children:[(0,i.jsxs)("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",marginBottom:"0.35rem"},children:[(0,i.jsx)("span",{className:"mha-titleIcon","aria-hidden":"true",style:{color:"var(--ifm-color-primary)"},children:(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{width:64,height:64},children:[(0,i.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,i.jsx)("path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2"}),(0,i.jsx)("path",{d:"M4 16v2a2 2 0 0 0 2 2h2"}),(0,i.jsx)("path",{d:"M16 4h2a2 2 0 0 1 2 2v2"}),(0,i.jsx)("path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2"}),(0,i.jsx)("path",{d:"M8 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"}),(0,i.jsx)("path",{d:"M16 16l-2.5 -2.5"})]})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"margin-bottom--sm",children:"Message Header Analyzer"}),(0,i.jsxs)("p",{style:{marginBottom:0},children:["Paste a raw e-mail header to extract the delivery path, timing, and antispam verdicts.",(0,i.jsx)("br",{}),(0,i.jsx)("strike",{children:"Copied wholesale"})," \ud83d\ude01 Freely inspired by the original Microsoft project (",(0,i.jsx)("a",{href:"https://github.com/microsoft/MHA",target:"_blank",children:"MHA"}),"), slightly revised in terms of the usability of the post-analysis page."]})]})]}),(0,i.jsx)("p",{style:{fontSize:".85rem",color:"var(--ifm-color-secondary-text)",marginTop:"1rem"},children:(0,i.jsxs)(r.A,{type:"danger",title:"Data Privacy",children:["Everything stays in your browser; no files are uploaded or stored on the server.",(0,i.jsx)("br",{}),"All analysis is performed by your browser."]})}),(0,i.jsxs)("div",{className:"mha-layout",children:[(0,i.jsxs)("div",{className:"mha-actions",children:[(0,i.jsx)("button",{className:"button button--primary button--sm",onClick:()=>{if(!e.trim())return void p("Paste a complete header before analyzing.");const{map:a,entries:t}=function(e){const a=[],t={};return function(e){const a=(e||"").replace(/\r\n?/g,"\n").split("\n"),t=[];for(const n of a)/^\s/.test(n)&&t.length>0?t[t.length-1]+=" "+n.trim():n.trim().length&&t.push(n.trimEnd());return t}(e).forEach(e=>{const n=e.indexOf(":");if(-1===n)return;const s=e.slice(0,n).trim(),r=e.slice(n+1).trim(),i=s.toLowerCase();a.push({name:s,value:r}),t[i]=t[i]?[...t[i],r]:[r]}),{entries:a,map:t}}(e),n=function(e){return e.map((a,t)=>{const n=e[t+1];let s=null;return a.dateObj&&n?.dateObj&&(s=Math.round((a.dateObj.getTime()-n.dateObj.getTime())/1e3)),{...a,delaySeconds:s}})}((a.received||[]).map(e=>function(e){const a=e.lastIndexOf(";"),t=-1!==a?e.slice(a+1).trim():"",n=-1!==a?e.slice(0,a).trim():e,s=n.match(/from\s+(.+?)\s+by\s+(.+?)(?:\s|$)/i),r=n.match(/\sby\s+(.+?)(?:\s|$)/i),i=n.match(/\swith\s+([^\s;]+)/i);return{submittingHost:s?s[1].trim():"",receivingHost:s?s[2].trim():r?r[1].trim():"",protocol:i?i[1].trim():"",dateString:t,dateObj:l(t),raw:e}}(e))),s=function(e,a){const t=e.date?.[0]||"",n=l(t),s=a[0],r=a[a.length-1],i=s?.dateObj&&r?.dateObj?Math.round((s.dateObj.getTime()-r.dateObj.getTime())/1e3):null;return{subject:e.subject?.[0]||"",messageId:e["message-id"]?.[0]||"",from:e.from?.[0]||"",to:e.to?.[0]||"",dateHeader:t,dateObj:n,hopCount:a.length,totalTransitSeconds:i}}(a,n),r=d(a["x-forefront-antispam-report"]?.[0]||""),i=d(a["x-microsoft-antispam"]?.[0]||""),o=c(a["authentication-results"],a["received-spf"]);m({summary:s,received:n,auth:o,forefront:r,antispam:i,rawMap:a,entries:t}),p(""),j("")},children:"Analyze headers"}),(0,i.jsx)("button",{className:"button button--secondary button--sm",onClick:()=>{a(""),m(null),p(""),j("")},children:"Clear"}),u&&(0,i.jsx)("span",{style:{color:"var(--ifm-color-danger)"},children:u})]}),(0,i.jsx)("textarea",{style:{width:"100%",minHeight:"220px"},placeholder:"Paste the full e-mail header here...",value:e,onChange:e=>a(e.target.value)}),t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"mha-exportActions",children:[(0,i.jsx)("button",{className:"button button--secondary button--sm",onClick:async()=>{if(t)try{await navigator.clipboard.writeText(f(t)),j("Analysis copied to clipboard.")}catch(e){j("Unable to copy to clipboard.")}},children:"Copy analysis"}),(0,i.jsx)("button",{className:"button button--secondary button--sm",onClick:()=>{if(!t)return;const e=new Blob([f(t)],{type:"text/plain"}),a=URL.createObjectURL(e),n=document.createElement("a");n.href=a,n.download="message-header-analysis.txt",n.click(),URL.revokeObjectURL(a),j("Text file downloaded.")},children:"Export as .txt"}),x&&(0,i.jsx)("span",{style:{color:"var(--ifm-color-secondary-text)"},children:x})]}),(0,i.jsxs)("section",{className:"mha-card",children:[(0,i.jsxs)("div",{className:"mha-cardHeader",children:[(0,i.jsx)(b,{icon:y.summary}),(0,i.jsx)("span",{children:"Summary"})]}),(0,i.jsxs)("div",{className:"mha-cardBody",children:[(0,i.jsx)("div",{className:"mha-summaryGrid",children:v.map(e=>(0,i.jsxs)("div",{className:"mha-summaryItem",children:[(0,i.jsx)("span",{className:"mha-summaryLabel",children:e.label}),(0,i.jsx)("span",{className:"mha-summaryValue",children:e.value})]},e.label))}),g&&(0,i.jsx)("p",{className:"mha-sectionHint",children:"No Received headers found. Check that you pasted the full message header (not just the body)."})]})]}),(0,i.jsxs)("section",{className:"mha-card",children:[(0,i.jsxs)("div",{className:"mha-cardHeader",children:[(0,i.jsx)(b,{icon:y.received}),(0,i.jsx)("span",{children:"Received path"})]}),(0,i.jsxs)("div",{className:"mha-cardBody",children:[!t.received.length&&(0,i.jsx)("p",{className:"mha-muted",children:"No Received headers available."}),t.received.length>0&&(0,i.jsx)("div",{className:"mha-tableWrapper",children:(0,i.jsxs)("table",{className:"mha-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{width:"60px"},children:"Hop"}),(0,i.jsx)("th",{children:"Submitting host"}),(0,i.jsx)("th",{children:"Receiving host"}),(0,i.jsx)("th",{style:{width:"220px"},children:"Time"}),(0,i.jsx)("th",{style:{width:"110px"},children:"Delay vs next"}),(0,i.jsx)("th",{style:{width:"120px"},children:"Protocol"})]})}),(0,i.jsx)("tbody",{children:t.received.map((e,a)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"mha-center",children:(0,i.jsx)("span",{className:"mha-chip",children:a+1})}),(0,i.jsx)("td",{className:"mha-mono",children:e.submittingHost||(0,i.jsx)("span",{className:"mha-muted",children:"Unknown"})}),(0,i.jsx)("td",{className:"mha-mono",children:e.receivingHost||(0,i.jsx)("span",{className:"mha-muted",children:"Unknown"})}),(0,i.jsx)("td",{children:e.dateObj?(0,i.jsxs)(i.Fragment,{children:[o(e.dateObj),(0,i.jsx)("div",{className:"mha-sectionHint",children:e.dateString})]}):e.dateString||(0,i.jsx)("span",{className:"mha-muted",children:"Not parsed"})}),(0,i.jsx)("td",{children:null===e.delaySeconds?(0,i.jsx)("span",{className:"mha-muted",children:"n/a"}):(0,i.jsx)("span",{className:e.delaySeconds<0?"mha-delay-bad":"mha-delay-good",children:h(e.delaySeconds)})}),(0,i.jsx)("td",{className:"mha-mono",children:e.protocol||(0,i.jsx)("span",{className:"mha-muted",children:"?"})})]},`${a}-${e.dateString}`))})]})})]})]}),(0,i.jsxs)("section",{className:"mha-card",children:[(0,i.jsxs)("div",{className:"mha-cardHeader",children:[(0,i.jsx)(b,{icon:y.auth}),(0,i.jsx)("span",{children:"Authentication"})]}),(0,i.jsxs)("div",{className:"mha-cardBody",children:[0===t.auth.length&&(0,i.jsx)("p",{className:"mha-muted",children:"No SPF/DKIM/DMARC results detected."}),t.auth.length>0&&(0,i.jsx)("div",{className:"mha-tableWrapper",children:(0,i.jsxs)("table",{className:"mha-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{width:"110px"},children:"Check"}),(0,i.jsx)("th",{style:{width:"140px"},children:"Result"}),(0,i.jsx)("th",{children:"Domain"}),(0,i.jsx)("th",{children:"Details"}),(0,i.jsx)("th",{style:{width:"170px"},children:"Source header"})]})}),(0,i.jsx)("tbody",{children:t.auth.map((e,a)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("strong",{children:e.mechanism})}),(0,i.jsx)("td",{className:e.result.includes("fail")||e.result.includes("softfail")?"mha-delay-bad":"mha-delay-good",children:e.result}),(0,i.jsx)("td",{className:"mha-mono",children:e.domain||(0,i.jsx)("span",{className:"mha-muted",children:"n/a"})}),(0,i.jsx)("td",{children:e.detail||(0,i.jsx)("span",{className:"mha-muted",children:"No extra info"})}),(0,i.jsx)("td",{className:"mha-muted",children:e.source})]},`${e.mechanism}-${a}`))})]})})]})]}),(t.forefront.length>0||t.antispam.length>0)&&(0,i.jsxs)("section",{className:"mha-card",children:[(0,i.jsxs)("div",{className:"mha-cardHeader",children:[(0,i.jsx)(b,{icon:y.antispam}),(0,i.jsx)("span",{children:"Antispam headers"})]}),(0,i.jsxs)("div",{className:"mha-cardBody",children:[t.forefront.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h3",{style:{marginBottom:"0.55rem"},children:"X-Forefront-Antispam-Report"}),(0,i.jsx)("div",{className:"mha-kvGrid",style:{marginBottom:"1.1rem"},children:t.forefront.map((e,a)=>(0,i.jsxs)("div",{className:"mha-kv",children:[(0,i.jsx)("strong",{children:e.key}),(0,i.jsx)("span",{children:e.value||(0,i.jsx)("span",{className:"mha-muted",children:"n/a"})})]},`ff-${a}`))})]}),t.antispam.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h3",{style:{marginBottom:"0.55rem"},children:"X-Microsoft-Antispam"}),(0,i.jsx)("div",{className:"mha-kvGrid",style:{marginBottom:"0.4rem"},children:t.antispam.map((e,a)=>(0,i.jsxs)("div",{className:"mha-kv",children:[(0,i.jsx)("strong",{children:e.key}),(0,i.jsx)("span",{children:e.value||(0,i.jsx)("span",{className:"mha-muted",children:"n/a"})})]},`msa-${a}`))})]})]})]}),t&&(0,i.jsxs)("section",{className:"mha-card",children:[(0,i.jsxs)("div",{className:"mha-cardHeader",children:[(0,i.jsx)(b,{icon:y.headers}),(0,i.jsx)("span",{children:"All headers"})]}),(0,i.jsx)("div",{className:"mha-cardBody",children:t.entries?.length?(0,i.jsx)("div",{className:"mha-tableWrapper",children:(0,i.jsxs)("table",{className:"mha-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{width:"70px"},children:"#"}),(0,i.jsx)("th",{style:{width:"240px"},children:"Header"}),(0,i.jsx)("th",{children:"Value"})]})}),(0,i.jsx)("tbody",{children:t.entries.map((e,a)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:a+1}),(0,i.jsx)("td",{style:{fontWeight:700},children:e.name}),(0,i.jsx)("td",{className:"mha-mono",children:e.value})]},`${e.name}-${a}`))})]})}):(0,i.jsx)("p",{className:"mha-muted",children:"No headers parsed."})})]})]})]})]})]})}}}]);