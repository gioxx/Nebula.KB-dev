"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[8558],{748(e,t,n){n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"Automations/usage/runtime","title":"Runtime Helpers","description":"Functions for script bootstrap, configuration, activity checks, and transcripts.","source":"@site/docs/Automations/usage/runtime.md","sourceDirName":"Automations/usage","slug":"/Automations/usage/runtime","permalink":"/Nebula.KB-dev/Nebula/Automations/usage/runtime","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Initialize-ScriptRuntime","permalink":"/Nebula.KB-dev/Nebula/tags/initialize-script-runtime"},{"inline":true,"label":"Resolve-ScriptConfigPaths","permalink":"/Nebula.KB-dev/Nebula/tags/resolve-script-config-paths"},{"inline":true,"label":"Start-ScriptTranscript","permalink":"/Nebula.KB-dev/Nebula/tags/start-script-transcript"},{"inline":true,"label":"Stop-ScriptTranscriptSafe","permalink":"/Nebula.KB-dev/Nebula/tags/stop-script-transcript-safe"},{"inline":true,"label":"Nebula.Automations","permalink":"/Nebula.KB-dev/Nebula/tags/nebula-automations"}],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Runtime Helpers","id":"runtime","description":"Functions for script bootstrap, configuration, activity checks, and transcripts.","tags":["Initialize-ScriptRuntime","Resolve-ScriptConfigPaths","Start-ScriptTranscript","Stop-ScriptTranscriptSafe","Nebula.Automations"]},"sidebar":"tutorialSidebar","previous":{"title":"Messaging","permalink":"/Nebula.KB-dev/Nebula/Automations/usage/messaging"},"next":{"title":"Scheduled Tasks","permalink":"/Nebula.KB-dev/Nebula/Automations/usage/scheduled-tasks"}}');var i=n(4848),s=n(8453);const c={sidebar_position:5,title:"Runtime Helpers",id:"runtime",description:"Functions for script bootstrap, configuration, activity checks, and transcripts.",tags:["Initialize-ScriptRuntime","Resolve-ScriptConfigPaths","Start-ScriptTranscript","Stop-ScriptTranscriptSafe","Nebula.Automations"]},d="Runtime Helpers",l={},o=[{value:"Import-PreferredModule",id:"import-preferredmodule",level:2},{value:"Initialize-ScriptRuntime",id:"initialize-scriptruntime",level:2},{value:"Resolve-ScriptConfigPaths",id:"resolve-scriptconfigpaths",level:2},{value:"Start-ScriptTranscript",id:"start-scripttranscript",level:2},{value:"Stop-ScriptTranscriptSafe",id:"stop-scripttranscriptsafe",level:2},{value:"Test-ScriptActivityLog",id:"test-scriptactivitylog",level:2},{value:"End-to-end bootstrap example",id:"end-to-end-bootstrap-example",level:2}];function a(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"runtime-helpers",children:"Runtime Helpers"})}),"\n",(0,i.jsxs)(t.p,{children:["This page collects the runtime bootstrap and operational helper functions. For full and always-up-to-date details, use ",(0,i.jsx)(t.code,{children:"Get-Help <FunctionName> -Detailed"})," (or ",(0,i.jsx)(t.code,{children:"-Examples"}),")."]}),"\n",(0,i.jsx)(t.h2,{id:"import-preferredmodule",children:"Import-PreferredModule"}),"\n",(0,i.jsx)(t.p,{children:"Import a module preferring an installed version or a specific source when needed."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Syntax"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:"Import-PreferredModule -ModuleName <String> [-DevManifestPath <String>] [-PreferDev <Boolean>] [-Force]\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Parameters"})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Parameter"}),(0,i.jsx)(t.th,{children:"Type"}),(0,i.jsx)(t.th,{children:"Description"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Default"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"ModuleName"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{children:"Name of the module to import."}),(0,i.jsx)(t.td,{children:"Yes"}),(0,i.jsx)(t.td,{children:"N/A"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"DevManifestPath"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsxs)(t.td,{children:["Path to a development ",(0,i.jsx)(t.code,{children:".psd1"})," manifest used when ",(0,i.jsx)(t.code,{children:"PreferDev"})," is enabled."]}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"None"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"PreferDev"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Boolean"})}),(0,i.jsx)(t.td,{children:"Prefer the development manifest when available."}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"True"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Force"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Switch"})}),(0,i.jsx)(t.td,{children:"Forces module import/reload behavior."}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})})]})]})]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Notes"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["If ",(0,i.jsx)(t.code,{children:"-PreferDev"})," is enabled and ",(0,i.jsx)(t.code,{children:"-DevManifestPath"})," exists, the module is imported from that manifest."]}),"\n",(0,i.jsxs)(t.li,{children:["Returns an object with ",(0,i.jsx)(t.code,{children:"Success"}),", ",(0,i.jsx)(t.code,{children:"Source"})," (",(0,i.jsx)(t.code,{children:"DEV"})," or ",(0,i.jsx)(t.code,{children:"Installed"}),"), ",(0,i.jsx)(t.code,{children:"Version"}),", ",(0,i.jsx)(t.code,{children:"Path"}),", and ",(0,i.jsx)(t.code,{children:"Message"}),"."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Example"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'$mod = Import-PreferredModule `\n  -ModuleName "Nebula.Automations" `\n  -DevManifestPath "C:\\Repos\\Nebula.Automations\\Nebula.Automations.psd1" `\n  -PreferDev $true `\n  -Force\n\nif (-not $mod.Success) { throw $mod.Message }\n'})}),"\n",(0,i.jsx)(t.h2,{id:"initialize-scriptruntime",children:"Initialize-ScriptRuntime"}),"\n",(0,i.jsx)(t.p,{children:"Initialize module imports, XML config loading, and optional log directory creation."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Syntax"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:"Initialize-ScriptRuntime -ConfigPath <String> [-ModulesToImport <String[]>] [-LogDirectory <String>] [-EnsureLogDirectory]\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Parameters"})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Parameter"}),(0,i.jsx)(t.th,{children:"Type"}),(0,i.jsx)(t.th,{children:"Description"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Default"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"ConfigPath"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{children:"Path to the XML configuration file to load."}),(0,i.jsx)(t.td,{children:"Yes"}),(0,i.jsx)(t.td,{children:"N/A"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"ModulesToImport"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String[]"})}),(0,i.jsx)(t.td,{children:"One or more module names to import before loading configuration."}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"@('Nebula.Log','Nebula.Automations')"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"LogDirectory"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{children:"Target log directory used by runtime helpers."}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"None"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"EnsureLogDirectory"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Switch"})}),(0,i.jsxs)(t.td,{children:["Creates ",(0,i.jsx)(t.code,{children:"LogDirectory"})," when it does not exist."]}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})})]})]})]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Notes"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Imports modules first, then loads XML config from ",(0,i.jsx)(t.code,{children:"-ConfigPath"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["With ",(0,i.jsx)(t.code,{children:"-EnsureLogDirectory"}),", creates the log folder if missing."]}),"\n",(0,i.jsxs)(t.li,{children:["Returns ",(0,i.jsx)(t.code,{children:"Success"}),", ",(0,i.jsx)(t.code,{children:"Config"}),", ",(0,i.jsx)(t.code,{children:"ConfigPath"}),", ",(0,i.jsx)(t.code,{children:"LogDirectory"}),", and ",(0,i.jsx)(t.code,{children:"Message"}),"."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Example"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'$runtime = Initialize-ScriptRuntime `\n  -ConfigPath "C:\\Config\\tenant.config.xml" `\n  -ModulesToImport @("Nebula.Log", "Nebula.Automations") `\n  -LogDirectory "C:\\Logs\\TenantA" `\n  -EnsureLogDirectory\n\nif (-not $runtime.Success) { throw $runtime.Message }\n'})}),"\n",(0,i.jsx)(t.h2,{id:"resolve-scriptconfigpaths",children:"Resolve-ScriptConfigPaths"}),"\n",(0,i.jsx)(t.p,{children:"Resolve configuration and runtime paths consistently across environments."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Syntax"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:"Resolve-ScriptConfigPaths -ScriptRoot <String> -ConfigRelativePath <String> `\n  [-ConfigRootPath <String>] [-LogRelativePath <String>] [-OutputRelativePath <String>] [-EnsureDirectories]\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Parameters"})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Parameter"}),(0,i.jsx)(t.th,{children:"Type"}),(0,i.jsx)(t.th,{children:"Description"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Default"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"ScriptRoot"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsxs)(t.td,{children:["Root path of the running script (typically ",(0,i.jsx)(t.code,{children:"$PSScriptRoot"}),")."]}),(0,i.jsx)(t.td,{children:"Yes"}),(0,i.jsx)(t.td,{children:"N/A"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"ConfigRelativePath"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsxs)(t.td,{children:["Config file path relative to ",(0,i.jsx)(t.code,{children:"ConfigRootPath"})," (or parent of ",(0,i.jsx)(t.code,{children:"ScriptRoot"}),")."]}),(0,i.jsx)(t.td,{children:"Yes"}),(0,i.jsx)(t.td,{children:"N/A"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"ConfigRootPath"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{children:"Explicit root folder for config path resolution."}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Parent of ScriptRoot"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"LogRelativePath"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{children:"Relative path used to build the resolved log directory."}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"None"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"OutputRelativePath"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{children:"Relative path used to build the resolved output file path."}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"None"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"EnsureDirectories"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Switch"})}),(0,i.jsx)(t.td,{children:"Creates missing parent directories for resolved log/output paths."}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})})]})]})]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Notes"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["If ",(0,i.jsx)(t.code,{children:"-ConfigRootPath"})," is omitted, config root defaults to parent of ",(0,i.jsx)(t.code,{children:"-ScriptRoot"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["Can compute ",(0,i.jsx)(t.code,{children:"ConfigPath"}),", ",(0,i.jsx)(t.code,{children:"LogDirectory"}),", and ",(0,i.jsx)(t.code,{children:"OutputPath"})," in one call."]}),"\n",(0,i.jsxs)(t.li,{children:["With ",(0,i.jsx)(t.code,{children:"-EnsureDirectories"}),", creates missing log/output parent directories."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Example"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'$paths = Resolve-ScriptConfigPaths `\n  -ScriptRoot $PSScriptRoot `\n  -ConfigRelativePath "Config\\tenant.config.xml" `\n  -LogRelativePath "Logs\\TenantA" `\n  -OutputRelativePath "Export\\result.json" `\n  -EnsureDirectories\n\nif (-not $paths.Success) { throw $paths.Message }\n'})}),"\n",(0,i.jsx)(t.h2,{id:"start-scripttranscript",children:"Start-ScriptTranscript"}),"\n",(0,i.jsx)(t.p,{children:"Safely start transcript logging."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Syntax"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:"Start-ScriptTranscript -OutputDirectory <String> [-CleanupOld] [-CleanupPattern <String>] [-IncludeInvocationHeader]\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Parameters"})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Parameter"}),(0,i.jsx)(t.th,{children:"Type"}),(0,i.jsx)(t.th,{children:"Description"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Default"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"OutputDirectory"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{children:"Folder where transcript files are written."}),(0,i.jsx)(t.td,{children:"Yes"}),(0,i.jsx)(t.td,{children:"N/A"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"CleanupOld"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Switch"})}),(0,i.jsxs)(t.td,{children:["Deletes old transcript files matching ",(0,i.jsx)(t.code,{children:"CleanupPattern"})," before start."]}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"CleanupPattern"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsxs)(t.td,{children:["Filename pattern used when ",(0,i.jsx)(t.code,{children:"CleanupOld"})," is enabled."]}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"PowerShell*.txt"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"IncludeInvocationHeader"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Switch"})}),(0,i.jsx)(t.td,{children:"Includes invocation header metadata in transcript output."}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"False"})})]})]})]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Notes"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Creates output directory when missing."}),"\n",(0,i.jsxs)(t.li,{children:["With ",(0,i.jsx)(t.code,{children:"-CleanupOld"}),", removes files matching ",(0,i.jsx)(t.code,{children:"-CleanupPattern"})," before starting transcript."]}),"\n",(0,i.jsxs)(t.li,{children:["Returns ",(0,i.jsx)(t.code,{children:"Success"}),", ",(0,i.jsx)(t.code,{children:"TranscriptPath"}),", and ",(0,i.jsx)(t.code,{children:"Message"}),"."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Example"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'$transcript = Start-ScriptTranscript `\n  -OutputDirectory "C:\\Logs\\TenantA" `\n  -CleanupOld `\n  -CleanupPattern "PowerShell*.txt"\n\nif (-not $transcript.Success) { throw $transcript.Message }\n'})}),"\n",(0,i.jsx)(t.h2,{id:"stop-scripttranscriptsafe",children:"Stop-ScriptTranscriptSafe"}),"\n",(0,i.jsx)(t.p,{children:"Safely stop transcript logging without breaking script execution flow."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Syntax"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:"Stop-ScriptTranscriptSafe\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Parameters"})}),"\n",(0,i.jsx)(t.p,{children:"This function has no parameters."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Notes"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"If no transcript is active, it does not fail the script."}),"\n",(0,i.jsxs)(t.li,{children:["Returns ",(0,i.jsx)(t.code,{children:"Success"})," and ",(0,i.jsx)(t.code,{children:"Message"}),"."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Example"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:"$stop = Stop-ScriptTranscriptSafe\nWrite-Output $stop.Message\n"})}),"\n",(0,i.jsx)(t.h2,{id:"test-scriptactivitylog",children:"Test-ScriptActivityLog"}),"\n",(0,i.jsx)(t.p,{children:"Evaluate script activity state based on a log/timestamp source."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Syntax"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:"Test-ScriptActivityLog -LogLocation <String>\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Parameters"})}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Parameter"}),(0,i.jsx)(t.th,{children:"Type"}),(0,i.jsx)(t.th,{children:"Description"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Default"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"LogLocation"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"String"})}),(0,i.jsx)(t.td,{children:"Path used to validate script activity logging capability."}),(0,i.jsx)(t.td,{children:"Yes"}),(0,i.jsx)(t.td,{children:"N/A"})]})})]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Notes"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Uses ",(0,i.jsx)(t.code,{children:"Test-ActivityLog"})," when available (typically from ",(0,i.jsx)(t.code,{children:"Nebula.Log"}),")."]}),"\n",(0,i.jsxs)(t.li,{children:["Falls back to a write/delete probe file test if ",(0,i.jsx)(t.code,{children:"Test-ActivityLog"})," is unavailable."]}),"\n",(0,i.jsxs)(t.li,{children:["Returns ",(0,i.jsx)(t.code,{children:"Success"}),", ",(0,i.jsx)(t.code,{children:"Status"})," (",(0,i.jsx)(t.code,{children:"OK"}),"/",(0,i.jsx)(t.code,{children:"KO"}),"), ",(0,i.jsx)(t.code,{children:"LogLocation"}),", and ",(0,i.jsx)(t.code,{children:"Message"}),"."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Example"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'$activity = Test-ScriptActivityLog -LogLocation "C:\\Logs\\TenantA"\nif ($activity.Status -ne "OK") { throw $activity.Message }\n'})}),"\n",(0,i.jsx)(t.h2,{id:"end-to-end-bootstrap-example",children:"End-to-end bootstrap example"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-powershell",children:'$paths = Resolve-ScriptConfigPaths `\n  -ScriptRoot $PSScriptRoot `\n  -ConfigRelativePath "Config\\tenant.config.xml" `\n  -LogRelativePath "Logs\\MyScript" `\n  -OutputRelativePath "Export\\result.json" `\n  -EnsureDirectories\nif (-not $paths.Success) { throw $paths.Message }\n\n$runtime = Initialize-ScriptRuntime `\n  -ConfigPath $paths.ConfigPath `\n  -ModulesToImport @("Nebula.Log", "Nebula.Automations") `\n  -LogDirectory $paths.LogDirectory `\n  -EnsureLogDirectory\nif (-not $runtime.Success) { throw $runtime.Message }\n\n$activity = Test-ScriptActivityLog -LogLocation $paths.LogDirectory\nif ($activity.Status -ne "OK") { throw $activity.Message }\n\n$transcript = Start-ScriptTranscript -OutputDirectory $paths.LogDirectory -CleanupOld\nif (-not $transcript.Success) { throw $transcript.Message }\n\ntry {\n  # Script workload here\n}\nfinally {\n  [void](Stop-ScriptTranscriptSafe)\n}\n'})})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453(e,t,n){n.d(t,{R:()=>c,x:()=>d});var r=n(6540);const i={},s=r.createContext(i);function c(e){const t=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);