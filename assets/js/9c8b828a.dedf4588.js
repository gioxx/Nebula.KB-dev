"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[4166],{1911(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"Automations/intro","title":"Getting started","description":"Get up and running with Nebula.Automations in minutes.","source":"@site/docs/Automations/intro.md","sourceDirName":"Automations","slug":"/Automations/intro","permalink":"/Nebula.KB-dev/Nebula/Automations/intro","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Getting started","permalink":"/Nebula.KB-dev/Nebula/tags/getting-started"},{"inline":true,"label":"Nebula.Automations","permalink":"/Nebula.KB-dev/Nebula/tags/nebula-automations"}],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Getting started","description":"Get up and running with Nebula.Automations in minutes.","hide_title":true,"id":"intro","tags":["Getting started","Nebula.Automations"]},"sidebar":"tutorialSidebar","previous":{"title":"Requirements","permalink":"/Nebula.KB-dev/Nebula/requirements"},"next":{"title":"Messaging overview","permalink":"/Nebula.KB-dev/Nebula/Automations/usage/messaging-overview"}}');var i=t(4848),l=t(8453),o=t(6025);const r={sidebar_position:1,title:"Getting started",description:"Get up and running with Nebula.Automations in minutes.",hide_title:!0,id:"intro",tags:["Getting started","Nebula.Automations"]},a="Getting started",c={},d=[{value:"Quick examples",id:"quick-examples",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Logging behavior",id:"logging-behavior",level:2},{value:"Installation from PowerShell Gallery",id:"installation-from-powershell-gallery",level:2},{value:"Update module",id:"update-module",level:2},{value:"Cleaning of previous installations (optional)",id:"cleaning-of-previous-installations-optional",level:2}];function h(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("img",{src:(0,o.Ay)("/img/Nebula.Automations.png"),alt:"Nebula.Automations",className:"nebula-doc-icon",style:{float:"right",maxWidth:"140px",marginLeft:"1rem"}}),"\n",(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"getting-started",children:"Getting started"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Nebula.Automations"})," is a PowerShell module that provides reusable functions for scripting, automation, and integration with cloud services.\nIt is the natural evolution of ",(0,i.jsx)(n.em,{children:"Nebula.Tools"})," and was created with a specific focus on automation."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Main features currently available:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Messaging: ",(0,i.jsx)(n.code,{children:"Send-Mail"}),", ",(0,i.jsx)(n.code,{children:"Send-ReportIfChanged"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Microsoft Graph connectivity: ",(0,i.jsx)(n.code,{children:"Test-MgGraphConnection"})," (alias ",(0,i.jsx)(n.code,{children:"CheckMGGraphConnection"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Scheduled task automation: ",(0,i.jsx)(n.code,{children:"Register-ScriptScheduledTask"}),", ",(0,i.jsx)(n.code,{children:"Unregister-ScriptScheduledTask"}),", ",(0,i.jsx)(n.code,{children:"Invoke-ScriptTaskLifecycle"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Runtime helpers: ",(0,i.jsx)(n.code,{children:"Import-PreferredModule"}),", ",(0,i.jsx)(n.code,{children:"Initialize-ScriptRuntime"}),", ",(0,i.jsx)(n.code,{children:"Resolve-ScriptConfigPaths"}),", ",(0,i.jsx)(n.code,{children:"Test-ScriptActivityLog"}),", ",(0,i.jsx)(n.code,{children:"Start-ScriptTranscript"}),", ",(0,i.jsx)(n.code,{children:"Stop-ScriptTranscriptSafe"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Logging fallback: if ",(0,i.jsx)(n.code,{children:"Nebula.Log"})," is not installed, the module exposes a compatible ",(0,i.jsx)(n.code,{children:"Write-Log"})," (alias ",(0,i.jsx)(n.code,{children:"Log-Message"}),") that internally calls ",(0,i.jsx)(n.code,{children:"Write-NALog"}),", so scripts using ",(0,i.jsx)(n.code,{children:"Write-Log"})," do not break."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"quick-examples",children:"Quick examples"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Send a daily report with an attachment:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:'Send-Mail `\n  -SMTPServer "smtp.contoso.com" `\n  -UseSsl `\n  -Credential (Get-Credential) `\n  -From "user@contoso.com" `\n  -To "sharedmailbox@contoso.com","user2@contoso.com" `\n  -Subject "Daily report" `\n  -Body "<h1>Report</h1><p>See attachment.</p>" `\n  -AttachmentPath "C:\\Reports\\daily.csv","C:\\Reports\\chart.pdf"\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Connect to Microsoft Graph using client credentials (app context):"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:'$secret = Get-Content "$env:APPDATA\\nebula\\.graph_secret.txt" -Raw\n$connected = Test-MgGraphConnection `\n  -TenantId "00000000-0000-0000-0000-000000000000" `\n  -ClientId "11111111-1111-1111-1111-111111111111" `\n  -ClientSecret $secret `\n  -LogLocation "$env:APPDATA\\nebula\\logs\\graph-connect.log" `\n  -AutoInstall `\n  -ShowInformations:$false\n\nif (-not $connected) { throw "Unable to connect to Microsoft Graph." }\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Register a daily scheduled task for a script:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:'Register-ScriptScheduledTask `\n  -TaskName "Daily-InventorySync" `\n  -TaskPath "\\Nebula\\" `\n  -ScriptPath "C:\\Ops\\Inventory\\Sync.ps1" `\n  -StartTime ((Get-Date).Date.AddHours(3)) `\n  -ScheduleType Daily `\n  -Force\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["Every function exposes built-in help. Use ",(0,i.jsx)(n.code,{children:"Get-Help <FunctionName> -Detailed"})," or ",(0,i.jsx)(n.code,{children:"-Examples"})," for notes, parameters, and prerequisites."]})}),"\n",(0,i.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"PowerShell 5.1+ or PowerShell 7+"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Send-Mail"}),": no external dependencies; uses .NET ",(0,i.jsx)(n.code,{children:"System.Net.Mail"}),". Supports credentials/TLS when the relay requires them."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Test-MgGraphConnection"}),": uses ",(0,i.jsx)(n.code,{children:"Microsoft.Graph"}),"; can auto-install it when ",(0,i.jsx)(n.code,{children:"-AutoInstall"})," is set. Logging relies on ",(0,i.jsx)(n.code,{children:"Write-Log"})," from ",(0,i.jsx)(n.code,{children:"Nebula.Log"}),"; if that module is missing, Nebula.Automations exposes a compatible ",(0,i.jsx)(n.code,{children:"Write-Log"}),"/",(0,i.jsx)(n.code,{children:"Log-Message"})," that delegates to ",(0,i.jsx)(n.code,{children:"Write-NALog"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Register-ScriptScheduledTask"}),": requires the ScheduledTasks module/cmdlets available on Windows hosts where Task Scheduler automation is supported."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"logging-behavior",children:"Logging behavior"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["When ",(0,i.jsx)(n.code,{children:"Nebula.Log"})," is installed, its ",(0,i.jsx)(n.code,{children:"Write-Log"})," is used."]}),"\n",(0,i.jsxs)(n.li,{children:["If ",(0,i.jsx)(n.code,{children:"Nebula.Log"})," is missing, Nebula.Automations publishes a compatible ",(0,i.jsx)(n.code,{children:"Write-Log"})," (alias ",(0,i.jsx)(n.code,{children:"Log-Message"}),") that delegates to ",(0,i.jsx)(n.code,{children:"Write-NALog"}),". This prevents scripts that call ",(0,i.jsx)(n.code,{children:"Write-Log"})," from failing."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Write-NALog"})," only uses ",(0,i.jsx)(n.code,{children:"Write-Log"})," when it comes from ",(0,i.jsx)(n.code,{children:"Nebula.Log"}),"; otherwise it writes to the transcript (and, when possible, to a file in the current directory or the supplied ",(0,i.jsx)(n.code,{children:"-LogLocation"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.h1,{id:"how-to-download-nebulaautomations",children:"How to download Nebula.Automations"}),"\n",(0,i.jsxs)(n.p,{children:["Nebula.Automations is available on the PowerShell Gallery.",(0,i.jsx)(n.br,{}),"\n","Its GitHub repository is available at ",(0,i.jsx)(n.a,{href:"https://github.com/gioxx/Nebula.Automations",children:"github.com/gioxx/Nebula.Automations"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"installation-from-powershell-gallery",children:"Installation from PowerShell Gallery"}),"\n",(0,i.jsxs)(n.p,{children:["This is definitely the recommended option and is currently the simplest, provided your machine has internet connectivity and the ability to download files from Microsoft's PowerShell Gallery (",(0,i.jsx)(n.a,{href:"https://www.powershellgallery.com/",children:"powershellgallery.com"}),")."]}),"\n",(0,i.jsxs)(n.p,{children:["The CurrentUser installs modules in a location that's accessible only to the current user of the computer (for example: ",(0,i.jsx)(n.code,{children:"$HOME\\Documents\\PowerShell\\Modules"}),"):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:"Install-Module -Name Nebula.Automations -Scope CurrentUser\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"AllUsers"})," scope installs modules in a location that's accessible to all users of the computer (",(0,i.jsx)(n.code,{children:"$env:ProgramFiles\\PowerShell\\Modules"}),"):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:"Install-Module -Name Nebula.Automations -Scope AllUsers\n"})}),"\n",(0,i.jsx)(n.p,{children:"When no Scope is defined, the default is set based on the PowerShellGet version."}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.p,{children:["In PowerShellGet 1.x versions, the default is ",(0,i.jsx)(n.code,{children:"AllUsers"}),", which requires elevation for install.",(0,i.jsx)(n.br,{}),"\n","For PowerShellGet versions 2.0.0 and above in PowerShell 6 or higher:"]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The default is CurrentUser, which doesn't require elevation for install."}),"\n",(0,i.jsxs)(n.li,{children:["If you are running in an elevated session, the default is ",(0,i.jsx)(n.code,{children:"AllUsers"}),"."]}),"\n"]}),(0,i.jsxs)(n.p,{children:["I recommend forcing the installation for ",(0,i.jsx)(n.code,{children:"AllUsers"})," so that the entire system can call the module's functions, regardless of where the script to be executed is located. Needless to say, the final assessment is up to you, and the module also works in a user context (the user who will install the module, of course)."]})]}),"\n",(0,i.jsx)(n.h2,{id:"update-module",children:"Update module"}),"\n",(0,i.jsxs)(n.p,{children:["The same rules mentioned in the previous paragraph apply. You can therefore also associate the ",(0,i.jsx)(n.code,{children:"Scope"})," parameter with the Update command."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:"Update-Module -Name Nebula.Automations\n"})}),"\n",(0,i.jsx)(n.h2,{id:"cleaning-of-previous-installations-optional",children:"Cleaning of previous installations (optional)"}),"\n",(0,i.jsxs)(n.p,{children:["The most up-to-date version of the module installed on your system will always be the one that PowerShell will prefer when you launch an ",(0,i.jsx)(n.code,{children:"Import-Module"})," or call one of the Nebula.Automations functions.",(0,i.jsx)(n.br,{}),"\n","In any case, if you want, you can always perform a complete cleanup of the installed versions and get the latest one (from PowerShell Gallery)."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:"Uninstall-Module -Name Nebula.Automations -AllVersions -Force\nInstall-Module -Name Nebula.Automations -Scope CurrentUser -Force\n"})})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453(e,n,t){t.d(n,{R:()=>o,x:()=>r});var s=t(6540);const i={},l=s.createContext(i);function o(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);