"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[6505],{2337(e,d,l){l.r(d),l.d(d,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Tools/usage/modules","title":"Modules","description":"Find, update, and clean up installed PowerShell modules.","source":"@site/docs/Tools/usage/modules.md","sourceDirName":"Tools/usage","slug":"/Tools/usage/modules","permalink":"/Nebula.KB-dev/Nebula/Tools/usage/modules","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Find-ModulesUpdates","permalink":"/Nebula.KB-dev/Nebula/tags/find-modules-updates"},{"inline":true,"label":"Modules","permalink":"/Nebula.KB-dev/Nebula/tags/modules"},{"inline":true,"label":"Nebula.Tools","permalink":"/Nebula.KB-dev/Nebula/tags/nebula-tools"},{"inline":true,"label":"Remove-OldModuleVersions","permalink":"/Nebula.KB-dev/Nebula/tags/remove-old-module-versions"},{"inline":true,"label":"Tools","permalink":"/Nebula.KB-dev/Nebula/tags/tools"},{"inline":true,"label":"Update-Modules","permalink":"/Nebula.KB-dev/Nebula/tags/update-modules"}],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Modules","description":"Find, update, and clean up installed PowerShell modules.","hide_title":true,"id":"modules","tags":["Find-ModulesUpdates","Modules","Nebula.Tools","Remove-OldModuleVersions","Tools","Update-Modules"]},"sidebar":"tutorialSidebar","previous":{"title":"Active Directory","permalink":"/Nebula.KB-dev/Nebula/Tools/usage/active-directory"},"next":{"title":"Security","permalink":"/Nebula.KB-dev/Nebula/Tools/usage/security"}}');var n=l(4848),r=l(8453);const t={sidebar_position:2,title:"Modules",description:"Find, update, and clean up installed PowerShell modules.",hide_title:!0,id:"modules",tags:["Find-ModulesUpdates","Modules","Nebula.Tools","Remove-OldModuleVersions","Tools","Update-Modules"]},i="Modules",o={},c=[{value:"Find-ModulesUpdates",id:"find-modulesupdates",level:2},{value:"Remove-OldModuleVersions",id:"remove-oldmoduleversions",level:2},{value:"Update-Modules",id:"update-modules",level:2},{value:"Questions and answers",id:"questions-and-answers",level:2},{value:"Do I need admin rights to update modules?",id:"do-i-need-admin-rights-to-update-modules",level:3},{value:"How do I clean old versions after an update?",id:"how-do-i-clean-old-versions-after-an-update",level:3}];function a(e){const d={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.header,{children:(0,n.jsx)(d.h1,{id:"modules",children:"Modules"})}),"\n",(0,n.jsxs)(d.p,{children:["For full details and examples, run ",(0,n.jsx)(d.code,{children:"Get-Help Find-ModulesUpdates -Detailed"}),", ",(0,n.jsx)(d.code,{children:"Get-Help Remove-OldModuleVersions -Detailed"}),", or ",(0,n.jsx)(d.code,{children:"Get-Help Update-Modules -Detailed"}),"."]}),"\n",(0,n.jsx)(d.h2,{id:"find-modulesupdates",children:"Find-ModulesUpdates"}),"\n",(0,n.jsx)(d.p,{children:"Checks installed modules for available updates using PSResourceGet (v3) or PowerShellGet (v2). Provider selection defaults to PSResourceGet and falls back to PowerShellGet when needed."}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Syntax"})}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-powershell",children:"Find-ModulesUpdates [-Scope <String>] [-Provider <String>] [-IncludePrerelease]\n"})}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Parameter"}),(0,n.jsx)(d.th,{children:"Description"}),(0,n.jsx)(d.th,{style:{textAlign:"center"},children:"Required"}),(0,n.jsx)(d.th,{children:"Default"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"IncludePrerelease"})}),(0,n.jsx)(d.td,{children:"Include prerelease versions."}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"False"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Provider"})}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"Auto"}),", ",(0,n.jsx)(d.code,{children:"PSResourceGet"}),", or ",(0,n.jsx)(d.code,{children:"PowerShellGet"}),"."]}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Auto"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Scope"})}),(0,n.jsxs)(d.td,{children:["Filter by install scope: ",(0,n.jsx)(d.code,{children:"User"}),", ",(0,n.jsx)(d.code,{children:"System"}),", ",(0,n.jsx)(d.code,{children:"All"}),", ",(0,n.jsx)(d.code,{children:"Unknown"}),"."]}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"All"})})]})]})]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Example"})}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-powershell",children:"Find-ModulesUpdates -Scope User -Provider Auto |\n  Sort-Object Name |\n  Format-Table Name, InstalledVersion, LatestVersion, Scope\n"})}),"\n",(0,n.jsx)(d.h2,{id:"remove-oldmoduleversions",children:"Remove-OldModuleVersions"}),"\n",(0,n.jsx)(d.p,{children:"Removes stale module folders while keeping the most recent releases."}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Syntax"})}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-powershell",children:"Remove-OldModuleVersions -Name <String> [-Keep <Int>] [-Force] [-WhatIf] [-Confirm]\n"})}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Parameter"}),(0,n.jsx)(d.th,{children:"Description"}),(0,n.jsx)(d.th,{style:{textAlign:"center"},children:"Required"}),(0,n.jsx)(d.th,{children:"Default"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Force"})}),(0,n.jsx)(d.td,{children:"Force removal where supported."}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"False"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Keep"})}),(0,n.jsx)(d.td,{children:"How many latest versions to keep."}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"1"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Name"})}),(0,n.jsx)(d.td,{children:"Target module name."}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"Yes"}),(0,n.jsx)(d.td,{children:"-"})]})]})]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Example"})}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-powershell",children:"# Keep the latest version and preview the removal\nRemove-OldModuleVersions -Name 'PSAppDeployToolkit' -Keep 1 -WhatIf\n"})}),"\n",(0,n.jsx)(d.h2,{id:"update-modules",children:"Update-Modules"}),"\n",(0,n.jsx)(d.p,{children:"Updates installed modules to the latest available version using the selected provider, with preview and optional cleanup."}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Syntax"})}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-powershell",children:"Update-Modules [-Scope <String>] [-Provider <String>] [-Name <String[]>] [-CleanupOld] [-IncludePrerelease] [-Preview]\n"})}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Parameter"}),(0,n.jsx)(d.th,{children:"Description"}),(0,n.jsx)(d.th,{style:{textAlign:"center"},children:"Required"}),(0,n.jsx)(d.th,{children:"Default"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"CleanupOld"})}),(0,n.jsx)(d.td,{children:"Remove older versions after updating."}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"False"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"IncludePrerelease"})}),(0,n.jsx)(d.td,{children:"Include prerelease versions."}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"False"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Name"})}),(0,n.jsx)(d.td,{children:"Optional module name filter (wildcards allowed)."}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(d.td,{children:"-"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Preview"})}),(0,n.jsx)(d.td,{children:"Show plan only; make no changes."}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"False"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Provider"})}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"Auto"}),", ",(0,n.jsx)(d.code,{children:"PSResourceGet"}),", or ",(0,n.jsx)(d.code,{children:"PowerShellGet"}),"."]}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Auto"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Scope"})}),(0,n.jsxs)(d.td,{children:["Target scope: ",(0,n.jsx)(d.code,{children:"User"}),", ",(0,n.jsx)(d.code,{children:"System"}),", ",(0,n.jsx)(d.code,{children:"All"}),", ",(0,n.jsx)(d.code,{children:"Unknown"}),"."]}),(0,n.jsx)(d.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"All"})})]})]})]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Examples"})}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-powershell",children:"# Dry run only\nUpdate-Modules -Scope User -Provider Auto -IncludePrerelease -Preview\n\n# Install updates and remove older copies\nUpdate-Modules -Scope User -CleanupOld\n"})}),"\n",(0,n.jsx)(d.h2,{id:"questions-and-answers",children:"Questions and answers"}),"\n",(0,n.jsx)(d.h3,{id:"do-i-need-admin-rights-to-update-modules",children:"Do I need admin rights to update modules?"}),"\n",(0,n.jsxs)(d.p,{children:["Only for system scope. ",(0,n.jsx)(d.code,{children:"Update-Modules -Scope User"})," and ",(0,n.jsx)(d.code,{children:"Find-ModulesUpdates"})," work without elevation; system-scope updates are skipped when not admin."]}),"\n",(0,n.jsx)(d.h3,{id:"how-do-i-clean-old-versions-after-an-update",children:"How do I clean old versions after an update?"}),"\n",(0,n.jsxs)(d.p,{children:["Run ",(0,n.jsx)(d.code,{children:"Update-Modules -CleanupOld"})," or ",(0,n.jsx)(d.code,{children:"Remove-OldModuleVersions -Name '<Module>' -Keep 1"})," for a specific module (add ",(0,n.jsx)(d.code,{children:"-WhatIf"})," for a preview)."]})]})}function h(e={}){const{wrapper:d}={...(0,r.R)(),...e.components};return d?(0,n.jsx)(d,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},8453(e,d,l){l.d(d,{R:()=>t,x:()=>i});var s=l(6540);const n={},r=s.createContext(n);function t(e){const d=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(d):{...d,...e}},[d,e])}function i(e){let d;return d=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:t(e.components),s.createElement(r.Provider,{value:d},e.children)}}}]);