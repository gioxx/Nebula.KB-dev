"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[8032],{3007(e,s,n){n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>d,default:()=>x,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Core/usage/mailboxes","title":"Mailboxes","description":"Manage aliases, permissions, languages, quotas, and shared mailbox setup.","source":"@site/docs/Core/usage/mailboxes.md","sourceDirName":"Core/usage","slug":"/Core/usage/mailboxes","permalink":"/Nebula.KB-dev/Nebula/Core/usage/mailboxes","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Add-MboxAlias","permalink":"/Nebula.KB-dev/Nebula/tags/add-mbox-alias"},{"inline":true,"label":"Add-MboxPermission","permalink":"/Nebula.KB-dev/Nebula/tags/add-mbox-permission"},{"inline":true,"label":"Export-MboxAlias","permalink":"/Nebula.KB-dev/Nebula/tags/export-mbox-alias"},{"inline":true,"label":"Export-MboxPermission","permalink":"/Nebula.KB-dev/Nebula/tags/export-mbox-permission"},{"inline":true,"label":"Get-MboxAlias","permalink":"/Nebula.KB-dev/Nebula/tags/get-mbox-alias"},{"inline":true,"label":"Get-MboxLastMessageTrace","permalink":"/Nebula.KB-dev/Nebula/tags/get-mbox-last-message-trace"},{"inline":true,"label":"Get-MboxPermission","permalink":"/Nebula.KB-dev/Nebula/tags/get-mbox-permission"},{"inline":true,"label":"Get-MboxPrimarySmtpAddress","permalink":"/Nebula.KB-dev/Nebula/tags/get-mbox-primary-smtp-address"},{"inline":true,"label":"Get-UserLastSeen","permalink":"/Nebula.KB-dev/Nebula/tags/get-user-last-seen"},{"inline":true,"label":"Nebula.Core","permalink":"/Nebula.KB-dev/Nebula/tags/nebula-core"},{"inline":true,"label":"New-SharedMailbox","permalink":"/Nebula.KB-dev/Nebula/tags/new-shared-mailbox"},{"inline":true,"label":"Remove-MboxAlias","permalink":"/Nebula.KB-dev/Nebula/tags/remove-mbox-alias"},{"inline":true,"label":"Remove-MboxPermission","permalink":"/Nebula.KB-dev/Nebula/tags/remove-mbox-permission"},{"inline":true,"label":"Set-MboxLanguage","permalink":"/Nebula.KB-dev/Nebula/tags/set-mbox-language"},{"inline":true,"label":"Set-MboxRulesQuota","permalink":"/Nebula.KB-dev/Nebula/tags/set-mbox-rules-quota"},{"inline":true,"label":"Set-SharedMboxCopyForSent","permalink":"/Nebula.KB-dev/Nebula/tags/set-shared-mbox-copy-for-sent"},{"inline":true,"label":"Test-SharedMailboxCompliance","permalink":"/Nebula.KB-dev/Nebula/tags/test-shared-mailbox-compliance"}],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"Mailboxes","description":"Manage aliases, permissions, languages, quotas, and shared mailbox setup.","hide_title":true,"id":"mailboxes","tags":["Add-MboxAlias","Add-MboxPermission","Export-MboxAlias","Export-MboxPermission","Get-MboxAlias","Get-MboxLastMessageTrace","Get-MboxPermission","Get-MboxPrimarySmtpAddress","Get-UserLastSeen","Nebula.Core","New-SharedMailbox","Remove-MboxAlias","Remove-MboxPermission","Set-MboxLanguage","Set-MboxRulesQuota","Set-SharedMboxCopyForSent","Test-SharedMailboxCompliance"]},"sidebar":"tutorialSidebar","previous":{"title":"Licenses","permalink":"/Nebula.KB-dev/Nebula/Core/usage/licenses"},"next":{"title":"Quarantine","permalink":"/Nebula.KB-dev/Nebula/Core/usage/quarantine"}}');var l=n(4848),i=n(8453);const t={sidebar_position:6,title:"Mailboxes",description:"Manage aliases, permissions, languages, quotas, and shared mailbox setup.",hide_title:!0,id:"mailboxes",tags:["Add-MboxAlias","Add-MboxPermission","Export-MboxAlias","Export-MboxPermission","Get-MboxAlias","Get-MboxLastMessageTrace","Get-MboxPermission","Get-MboxPrimarySmtpAddress","Get-UserLastSeen","Nebula.Core","New-SharedMailbox","Remove-MboxAlias","Remove-MboxPermission","Set-MboxLanguage","Set-MboxRulesQuota","Set-SharedMboxCopyForSent","Test-SharedMailboxCompliance"]},d="Mailbox helpers",a={},c=[{value:"Add-MboxAlias",id:"add-mboxalias",level:2},{value:"Add-MboxPermission",id:"add-mboxpermission",level:2},{value:"Export-MboxAlias",id:"export-mboxalias",level:2},{value:"Export-MboxPermission",id:"export-mboxpermission",level:2},{value:"Get-MboxAlias",id:"get-mboxalias",level:2},{value:"Get-MboxLastMessageTrace",id:"get-mboxlastmessagetrace",level:2},{value:"Get-MboxPermission",id:"get-mboxpermission",level:2},{value:"Get-MboxPrimarySmtpAddress",id:"get-mboxprimarysmtpaddress",level:2},{value:"Get-UserLastSeen",id:"get-userlastseen",level:2},{value:"New-SharedMailbox",id:"new-sharedmailbox",level:2},{value:"Remove-MboxAlias",id:"remove-mboxalias",level:2},{value:"Remove-MboxPermission",id:"remove-mboxpermission",level:2},{value:"Set-MboxLanguage",id:"set-mboxlanguage",level:2},{value:"Set-MboxRulesQuota",id:"set-mboxrulesquota",level:2},{value:"Set-SharedMboxCopyForSent",id:"set-sharedmboxcopyforsent",level:2},{value:"Test-SharedMailboxCompliance",id:"test-sharedmailboxcompliance",level:2}];function o(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.header,{children:(0,l.jsx)(s.h1,{id:"mailbox-helpers",children:"Mailbox helpers"})}),"\n",(0,l.jsxs)(s.p,{children:["Requires an EXO session. For full and always-up-to-date details, use ",(0,l.jsx)(s.code,{children:"Get-Help <FunctionName> -Detailed"}),"."]}),"\n",(0,l.jsx)(s.h2,{id:"add-mboxalias",children:"Add-MboxAlias"}),"\n",(0,l.jsx)(s.p,{children:"Add SMTP aliases on a recipient."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Add-MboxAlias -SourceMailbox <String> -MailboxAlias <String>\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsxs)(s.td,{children:[(0,l.jsx)(s.code,{children:"SourceMailbox"})," (",(0,l.jsx)(s.code,{children:"Identity"}),")"]}),(0,l.jsx)(s.td,{children:"Target mailbox/recipient. Pipeline accepted."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"MailboxAlias"})}),(0,l.jsx)(s.td,{children:"Alias (SMTP address) to add."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Examples"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Add-MboxAlias -SourceMailbox 'info@contoso.com' -MailboxAlias 'alias@contoso.com'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Add-MboxAlias -Identity 'user@contoso.com' -Aliases 'user.sales@contoso.com','user.eu@contoso.com'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"add-mboxpermission",children:"Add-MboxPermission"}),"\n",(0,l.jsx)(s.p,{children:"Grant mailbox permissions."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Add-MboxPermission -Identity <String> -User <String> -AccessRights <String[]> [-AutoMapping]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Identity"})}),(0,l.jsx)(s.td,{children:"Target mailbox."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"User"})}),(0,l.jsx)(s.td,{children:"Principal to grant."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"AccessRights"})}),(0,l.jsx)(s.td,{children:"Rights (e.g., FullAccess, SendAs, SendOnBehalf)."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"AutoMapping"})}),(0,l.jsx)(s.td,{children:"Enable/disable Outlook automapping."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Examples"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Add-MboxPermission -Identity 'shared@contoso.com' -User 'john@contoso.com' -AccessRights FullAccess -AutoMapping:$false\n"})}),"\n",(0,l.jsx)(s.h2,{id:"export-mboxalias",children:"Export-MboxAlias"}),"\n",(0,l.jsx)(s.p,{children:"Export aliases for auditing."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Export-MboxAlias -Identity <String> [-CsvFolder <String>]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Identity"})}),(0,l.jsx)(s.td,{children:"Target mailbox/recipient."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"CsvFolder"})}),(0,l.jsx)(s.td,{children:"Destination folder for CSV export."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Examples"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Export-MboxAlias -Identity 'user@contoso.com' -CsvFolder 'C:\\Temp'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"export-mboxpermission",children:"Export-MboxPermission"}),"\n",(0,l.jsx)(s.p,{children:"Export mailbox permissions to CSV."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Export-MboxPermission -Identity <String> [-CsvFolder <String>]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Identity"})}),(0,l.jsx)(s.td,{children:"Target mailbox."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"CsvFolder"})}),(0,l.jsx)(s.td,{children:"Destination folder for CSV export."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Examples"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Export-MboxPermission -Identity 'shared@contoso.com' -CsvFolder 'C:\\Temp'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"get-mboxalias",children:"Get-MboxAlias"}),"\n",(0,l.jsx)(s.p,{children:"List aliases for auditing."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-MboxAlias -Identity <String>\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,l.jsx)(s.tbody,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Identity"})}),(0,l.jsx)(s.td,{children:"Target mailbox/recipient."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]})})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Examples"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-MboxAlias -Identity 'user@contoso.com'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"get-mboxlastmessagetrace",children:"Get-MboxLastMessageTrace"}),"\n",(0,l.jsx)(s.p,{children:"Return the most recent received and sent message traces for a mailbox."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-MboxLastMessageTrace -SourceMailbox <String> [-IncludeTrace]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsxs)(s.td,{children:[(0,l.jsx)(s.code,{children:"SourceMailbox"})," (",(0,l.jsx)(s.code,{children:"Identity"}),")"]}),(0,l.jsx)(s.td,{children:"Target mailbox/recipient. Pipeline accepted."})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"IncludeTrace"})}),(0,l.jsx)(s.td,{children:"Include raw message trace objects in the output."})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-MboxLastMessageTrace -SourceMailbox 'user@contoso.com'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-MboxLastMessageTrace -SourceMailbox 'user@contoso.com' -IncludeTrace\n"})}),"\n",(0,l.jsx)(s.h2,{id:"get-mboxpermission",children:"Get-MboxPermission"}),"\n",(0,l.jsx)(s.p,{children:"List mailbox permissions."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-MboxPermission -Identity <String>\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,l.jsx)(s.tbody,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Identity"})}),(0,l.jsx)(s.td,{children:"Target mailbox."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]})})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Examples"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-MboxPermission -Identity 'shared@contoso.com'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"get-mboxprimarysmtpaddress",children:"Get-MboxPrimarySmtpAddress"}),"\n",(0,l.jsx)(s.p,{children:"Return the PrimarySmtpAddress for a mailbox or recipient."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-MboxPrimarySmtpAddress -SourceMailbox <String[]> [-Raw]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsxs)(s.td,{children:[(0,l.jsx)(s.code,{children:"SourceMailbox"})," (",(0,l.jsx)(s.code,{children:"Identity"}),")"]}),(0,l.jsx)(s.td,{children:"Target mailbox/recipient. Pipeline accepted."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Raw"})}),(0,l.jsx)(s.td,{children:"Return only the PrimarySmtpAddress values."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"})]})]})]}),"\n",(0,l.jsx)(s.admonition,{type:"tip",children:(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"Get-MboxPrimarySmtpAddress"})," is also available as ",(0,l.jsx)(s.code,{children:"gpa"})," (alias)."]})}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-MboxPrimarySmtpAddress -SourceMailbox 'user@contoso.com'\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-MboxPrimarySmtpAddress -SourceMailbox 'user@contoso.com' -Raw\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"gpa 'user@contoso.com' -Raw\n"})}),"\n",(0,l.jsx)(s.h2,{id:"get-userlastseen",children:"Get-UserLastSeen"}),"\n",(0,l.jsx)(s.p,{children:"Return the most recent activity for a mailbox combining Exchange LastUserActionTime and (when available) Entra ID sign-in logs."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-UserLastSeen -User <String>\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"})]})}),(0,l.jsx)(s.tbody,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsxs)(s.td,{children:[(0,l.jsx)(s.code,{children:"User"})," (",(0,l.jsx)(s.code,{children:"Identity"}),", ",(0,l.jsx)(s.code,{children:"UserPrincipalName"}),")"]}),(0,l.jsx)(s.td,{children:"Target mailbox identity. Pipeline accepted."})]})})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Get-UserLastSeen -User 'alice@contoso.com'\n"})}),"\n",(0,l.jsx)(s.p,{children:"Notes:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Requires Exchange Online connection. Graph sign-in logs are included when ",(0,l.jsx)(s.code,{children:"AuditLog.Read.All"})," + ",(0,l.jsx)(s.code,{children:"Directory.Read.All"})," scopes are available."]}),"\n",(0,l.jsxs)(s.li,{children:["Output includes ",(0,l.jsx)(s.code,{children:"LastUserActionTime"}),", ",(0,l.jsx)(s.code,{children:"LastInteractiveSignIn"}),", ",(0,l.jsx)(s.code,{children:"LastSeen"}),", and the ",(0,l.jsx)(s.code,{children:"Source"})," used."]}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"new-sharedmailbox",children:"New-SharedMailbox"}),"\n",(0,l.jsx)(s.p,{children:"Create a shared mailbox."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"New-SharedMailbox -Name <String> -Alias <String> -PrimarySmtpAddress <String> [-Members <String[]>]\n                  [-Language <String>] [-TimeZone <String>]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Name"})}),(0,l.jsx)(s.td,{children:"Display name."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Alias"})}),(0,l.jsx)(s.td,{children:"Mail alias."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"PrimarySmtpAddress"})}),(0,l.jsx)(s.td,{children:"Primary SMTP."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Members"})}),(0,l.jsx)(s.td,{children:"Members to grant FullAccess/SendAs."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsxs)(s.td,{children:[(0,l.jsx)(s.code,{children:"Language"})," / ",(0,l.jsx)(s.code,{children:"TimeZone"})]}),(0,l.jsx)(s.td,{children:"Optional localization."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"New-SharedMailbox -Name \"Support\" -Alias 'support' -PrimarySmtpAddress 'support@contoso.com' -Members 'agent1@contoso.com','agent2@contoso.com'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"remove-mboxalias",children:"Remove-MboxAlias"}),"\n",(0,l.jsx)(s.p,{children:"Remove SMTP aliases from a recipient."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-MboxAlias -SourceMailbox <String> -MailboxAlias <String>\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsxs)(s.td,{children:[(0,l.jsx)(s.code,{children:"SourceMailbox"})," (",(0,l.jsx)(s.code,{children:"Identity"}),")"]}),(0,l.jsx)(s.td,{children:"Target mailbox/recipient. Pipeline accepted."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"MailboxAlias"})}),(0,l.jsx)(s.td,{children:"Alias (SMTP address) to remove."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Examples"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-MboxAlias -SourceMailbox 'info@contoso.com' -MailboxAlias 'alias@contoso.com'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"remove-mboxpermission",children:"Remove-MboxPermission"}),"\n",(0,l.jsx)(s.p,{children:"Revoke mailbox permissions."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-MboxPermission -SourceMailbox <String> -UserMailbox <String[]> [-AccessRights <String>]\nRemove-MboxPermission -SourceMailbox <String> -ClearAll\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsxs)(s.td,{children:[(0,l.jsx)(s.code,{children:"SourceMailbox"})," (",(0,l.jsx)(s.code,{children:"Identity"}),")"]}),(0,l.jsx)(s.td,{children:"Target mailbox."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"UserMailbox"})}),(0,l.jsx)(s.td,{children:"Principal(s) to revoke."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes (User mode)"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"AccessRights"})}),(0,l.jsx)(s.td,{children:"Rights (e.g., FullAccess, SendAs, SendOnBehalfTo). Defaults to All."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"ClearAll"})}),(0,l.jsx)(s.td,{children:"Remove all non-inherited FullAccess, SendAs, and SendOnBehalfTo permissions from the source mailbox."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes (All mode)"})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Examples"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-MboxPermission -SourceMailbox 'shared@contoso.com' -UserMailbox 'john@contoso.com' -AccessRights FullAccess\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Remove-MboxPermission -SourceMailbox 'shared@contoso.com' -ClearAll\n"})}),"\n",(0,l.jsx)(s.h2,{id:"set-mboxlanguage",children:"Set-MboxLanguage"}),"\n",(0,l.jsx)(s.p,{children:"Set mailbox UI language, time zone, and regional settings."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Set-MboxLanguage -UserPrincipalName <String> [-Language <String>] [-TimeZone <String>]\n                 [-DateFormat <String>] [-TimeFormat <String>]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsxs)(s.td,{children:[(0,l.jsx)(s.code,{children:"UserPrincipalName"})," (",(0,l.jsx)(s.code,{children:"Identity"}),")"]}),(0,l.jsx)(s.td,{children:"Target mailbox."})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Language"})}),(0,l.jsx)(s.td,{children:"Culture code (e.g., it-IT, en-US)."})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"TimeZone"})}),(0,l.jsx)(s.td,{children:"Time zone ID (e.g., W. Europe Standard Time)."})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsxs)(s.td,{children:[(0,l.jsx)(s.code,{children:"DateFormat"})," / ",(0,l.jsx)(s.code,{children:"TimeFormat"})]}),(0,l.jsx)(s.td,{children:"Optional overrides."})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Set-MboxLanguage -UserPrincipalName 'user@contoso.com' -Language it-IT -TimeZone \"W. Europe Standard Time\"\n"})}),"\n",(0,l.jsx)(s.h2,{id:"set-mboxrulesquota",children:"Set-MboxRulesQuota"}),"\n",(0,l.jsx)(s.p,{children:"Adjust inbox rules quota for a mailbox."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Set-MboxRulesQuota -Identity <String> -RulesQuotaInKB <Int>\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Identity"})}),(0,l.jsx)(s.td,{children:"Target mailbox."})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"RulesQuotaInKB"})}),(0,l.jsx)(s.td,{children:"New quota in KB."})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Set-MboxRulesQuota -Identity 'user@contoso.com' -RulesQuotaInKB 128\n"})}),"\n",(0,l.jsx)(s.h2,{id:"set-sharedmboxcopyforsent",children:"Set-SharedMboxCopyForSent"}),"\n",(0,l.jsx)(s.p,{children:"Toggle saving sent items for delegated send-as/send-on-behalf."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Set-SharedMboxCopyForSent -Identity <String> [-Enable]\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"}),(0,l.jsx)(s.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Identity"})}),(0,l.jsx)(s.td,{children:"Shared mailbox."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Enable"})}),(0,l.jsx)(s.td,{children:"Switch to enable; omit for disable."}),(0,l.jsx)(s.td,{style:{textAlign:"center"},children:"No"})]})]})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Set-SharedMboxCopyForSent -Identity 'shared@contoso.com' -Enable\n"})}),"\n",(0,l.jsx)(s.h2,{id:"test-sharedmailboxcompliance",children:"Test-SharedMailboxCompliance"}),"\n",(0,l.jsx)(s.p,{children:"Quick checks on shared mailbox configuration (permissions, quotas, sent-items copy)."}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Syntax"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Test-SharedMailboxCompliance -Identity <String>\n"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Parameter"}),(0,l.jsx)(s.th,{children:"Description"})]})}),(0,l.jsx)(s.tbody,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"Identity"})}),(0,l.jsx)(s.td,{children:"Shared mailbox to validate."})]})})]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Example"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-powershell",children:"Test-SharedMailboxCompliance -Identity 'shared@contoso.com'\n"})})]})}function x(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},8453(e,s,n){n.d(s,{R:()=>t,x:()=>d});var r=n(6540);const l={},i=r.createContext(l);function t(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);