"use strict";(globalThis.webpackChunknebula=globalThis.webpackChunknebula||[]).push([[6553],{3999(e,t,n){n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>r});const a=JSON.parse('{"id":"Automations/usage/more-examples","title":"More examples","description":"Practical recipes that show common ways to use Nebula.Automations.","source":"@site/docs/Automations/usage/more-examples.md","sourceDirName":"Automations/usage","slug":"/Automations/usage/more-examples","permalink":"/Nebula.KB-dev/Nebula/Automations/usage/more-examples","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Nebula.Automations","permalink":"/Nebula.KB-dev/Nebula/tags/nebula-automations"},{"inline":true,"label":"Examples","permalink":"/Nebula.KB-dev/Nebula/tags/examples"},{"inline":true,"label":"Automations","permalink":"/Nebula.KB-dev/Nebula/tags/automations"}],"version":"current","sidebarPosition":50,"frontMatter":{"sidebar_position":50,"title":"More examples","description":"Practical recipes that show common ways to use Nebula.Automations.","hide_title":true,"id":"more-examples","tags":["Nebula.Automations","Examples","Automations"]},"sidebar":"tutorialSidebar","previous":{"title":"Write-Log (fallback)","permalink":"/Nebula.KB-dev/Nebula/Automations/usage/write-log"},"next":{"title":"Getting started","permalink":"/Nebula.KB-dev/Nebula/Core/intro"}}');var o=n(4848),i=n(8453);const s={sidebar_position:50,title:"More examples",description:"Practical recipes that show common ways to use Nebula.Automations.",hide_title:!0,id:"more-examples",tags:["Nebula.Automations","Examples","Automations"]},l="More examples",c={},r=[{value:"Send a styled HTML e-mail",id:"send-a-styled-html-e-mail",level:2},{value:"Authenticated SMTP with TLS and attachments",id:"authenticated-smtp-with-tls-and-attachments",level:2},{value:"Plain-text notification to multiple recipients (To + CC + BCC)",id:"plain-text-notification-to-multiple-recipients-to--cc--bcc",level:2},{value:"Validate Microsoft Graph app connectivity",id:"validate-microsoft-graph-app-connectivity",level:2},{value:"Auto-install Microsoft.Graph if missing",id:"auto-install-microsoftgraph-if-missing",level:2},{value:"Register a daily script task (standard mode)",id:"register-a-daily-script-task-standard-mode",level:2},{value:"Register with custom XML (advanced scheduling)",id:"register-with-custom-xml-advanced-scheduling",level:2},{value:"Remove a scheduled script task",id:"remove-a-scheduled-script-task",level:2}];function d(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"more-examples",children:"More examples"})}),"\n",(0,o.jsx)(t.p,{children:"Practical recipes that show common ways to use Nebula.Automations."}),"\n",(0,o.jsx)(t.h2,{id:"send-a-styled-html-e-mail",children:"Send a styled HTML e-mail"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-powershell",children:'$body = @"\n<h2 style="color:#0a6ebd;">Report ready</h2>\n<p>The nightly batch finished successfully.</p>\n"@\n\nSend-Mail `\n  -SMTPServer "smtp.contoso.com" `\n  -From "user@contoso.com" `\n  -To "sharedmailbox@contoso.com" `\n  -Subject "Nightly batch OK" `\n  -Body $body\n'})}),"\n",(0,o.jsx)(t.h2,{id:"authenticated-smtp-with-tls-and-attachments",children:"Authenticated SMTP with TLS and attachments"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-powershell",children:'$cred = Get-Credential  # relay credentials\n\nSend-Mail `\n  -SMTPServer "smtp.contoso.com" `\n  -SMTPPort 587 `\n  -UseSsl `\n  -Credential $cred `\n  -From "user@contoso.com" `\n  -To "sharedmailbox@contoso.com" `\n  -Subject "Alert with attachment" `\n  -Body "<p>See attached log.</p>" `\n  -AttachmentPath "C:\\Logs\\alert.log"\n'})}),"\n",(0,o.jsx)(t.h2,{id:"plain-text-notification-to-multiple-recipients-to--cc--bcc",children:"Plain-text notification to multiple recipients (To + CC + BCC)"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-powershell",children:'Send-Mail `\n  -SMTPServer "smtp.contoso.com" `\n  -From "user@contoso.com" `\n  -To "user1@contoso.com","user2@contoso.com" `\n  -Cc "sharedmailbox@contoso.com" `\n  -Bcc "user3@contoso.com" `\n  -Subject "Maintenance window" `\n  -Body "Service downtime tonight 22:00-23:00 UTC." `\n  -PlainText\n'})}),"\n",(0,o.jsx)(t.h2,{id:"validate-microsoft-graph-app-connectivity",children:"Validate Microsoft Graph app connectivity"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-powershell",children:'$connected = Test-MgGraphConnection `\n  -TenantId "00000000-0000-0000-0000-000000000000" `\n  -ClientId "11111111-1111-1111-1111-111111111111" `\n  -ClientSecret (Get-Content "$env:APPDATA\\\\nebula\\\\.graph_secret.txt" -Raw) `\n  -LogLocation "$env:APPDATA\\\\nebula\\\\logs\\\\graph-connect.log"\n\nif (-not $connected) { throw "Unable to connect to Microsoft Graph." }\n'})}),"\n",(0,o.jsx)(t.h2,{id:"auto-install-microsoftgraph-if-missing",children:"Auto-install Microsoft.Graph if missing"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-powershell",children:'if (-not (Test-MgGraphConnection -TenantId $tenantId -ClientId $clientId -ClientSecret $clientSecret -AutoInstall)) {\n    throw "Graph connection failed even after installing Microsoft.Graph."\n}\n'})}),"\n",(0,o.jsx)(t.h2,{id:"register-a-daily-script-task-standard-mode",children:"Register a daily script task (standard mode)"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-powershell",children:'Register-ScriptScheduledTask `\n  -TaskName "Daily-PolicyAudit" `\n  -TaskPath "\\Nebula\\" `\n  -Mode Standard `\n  -ScriptPath "C:\\Ops\\Audit\\Invoke-PolicyAudit.ps1" `\n  -StartTime ((Get-Date).Date.AddHours(2)) `\n  -ScheduleType Daily `\n  -RunElevated\n'})}),"\n",(0,o.jsx)(t.h2,{id:"register-with-custom-xml-advanced-scheduling",children:"Register with custom XML (advanced scheduling)"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-powershell",children:'$cred = Get-Credential\n\nRegister-ScriptScheduledTask `\n  -TaskName "ConditionalAccess-Automation" `\n  -Mode Xml `\n  -TaskXmlPath "C:\\Ops\\TaskXml\\ConditionalAccess.xml" `\n  -Credential $cred `\n  -Force\n'})}),"\n",(0,o.jsx)(t.h2,{id:"remove-a-scheduled-script-task",children:"Remove a scheduled script task"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-powershell",children:'Unregister-ScriptScheduledTask `\n  -TaskName "Daily-PolicyAudit" `\n  -TaskPath "\\Nebula\\"\n'})})]})}function u(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453(e,t,n){n.d(t,{R:()=>s,x:()=>l});var a=n(6540);const o={},i=a.createContext(o);function s(e){const t=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);